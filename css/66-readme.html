<div class="announce instapaper_body md" data-path="README.md" id="readme"><article class="markdown-body entry-content" itemprop="mainContentOfPage"><h1>
<a name="user-content-graphene" class="anchor" href="#graphene" aria-hidden="true"><span class="octicon octicon-link"></span></a>Graphene</h1>

<p><a href="http://jondot.github.com/graphene/">Graphene</a> is a realtime dashboard &amp; graphing toolkit based on <a href="http://mbostock.github.com/d3/">D3</a> and <a href="http://documentcloud.github.com/backbone/">Backbone</a>.  </p>

<p>It was made to offer a very aesthetic realtime dashboard that lives on top of <a href="http://graphite.wikidot.com/">Graphite</a> (but could be tailored to any back
end, eventually).  </p>

<p>Combining D3's immense capabilities of managing live data, and Backbone's
ease of development, Graphene provides a solution capable of
displaying thousands upon thousands of datapoints in your dashboard, as well as presenting a very hackable project to build on and customize.</p>

<h1>
<a name="user-content-getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span class="octicon octicon-link"></span></a>Getting Started</h1>

<p>Currently, Graphene loves Graphite's data model (through its API).  </p>

<p>To start,</p>

<pre><code>$ git clone git://github.com/jondot/graphene.git
$ cd graphene
</code></pre>

<h2>
<a name="user-content-running-the-example" class="anchor" href="#running-the-example" aria-hidden="true"><span class="octicon octicon-link"></span></a>Running the Example</h2>

<p>Use the <code>/example</code> dashboard to build on.</p>

<p>You should serve that folder off some kind of a helper webserver. For
Ruby:</p>

<pre><code>$ gem install serve
$ serve .
</code></pre>

<p>And open up your browser at <code>http://localhost:4000/example/dashboard.html</code>. You
should see the dashboard alive, rigged with a demo data provider.</p>

<h2>
<a name="user-content-setting-up-a-dev-env" class="anchor" href="#setting-up-a-dev-env" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setting up a Dev Env</h2>

<p>This is a no brainer. You gotta have Ruby though; back to your root
Graphene folder,</p>

<pre><code>$ bundle install
$ bundle exec guard start
</code></pre>

<p>This gives you an autogenerated build when you modify stuff in app/css
and app/js. Take note that <code>dashboard.html</code> points to the <code>build</code> folder
where your assets are automatically built to.</p>

<h2>
<a name="user-content-building-a-dashboard" class="anchor" href="#building-a-dashboard" aria-hidden="true"><span class="octicon octicon-link"></span></a>Building a Dashboard</h2>

<p>You are probably wondering how do you disconnect the demo data provider
and plug the Graphite data source. Don't worry - more about it
after this.  </p>

<p>As of now, you can place 3 types of data-enabled widgets on your
dashboard: <code>TimeSeries</code>, <code>GaugeLabel</code>, and a <code>GaugeGadget</code><br>
You can have as many of these as you want, and you can also hook up
several widgets to the same data source.</p>

<p>To build a new dashboard, you can/should use the builder:</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">g</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Graphene</span><span class="p">;</span>
<span class="nx">g</span><span class="p">.</span><span class="nx">demo</span><span class="p">();</span> <span class="c1">// hook up demo provider, override all urls.</span>
<span class="nx">g</span><span class="p">.</span><span class="nx">build</span><span class="p">(</span><span class="nx">description</span><span class="p">);</span>
</pre></div>

<p>Where <code>description</code> will be the hardest thing you'll have to do here. It is a hash structure, note that urls (since we use demo provider) do nothing. Here:</p>

<div class="highlight highlight-javascript"><pre><span class="nx">description</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"Total Notifications"</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">source</span><span class="o">:</span> <span class="s2">"http://localhost:4567/"</span><span class="p">,</span>
    <span class="nx">GaugeLabel</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">parent</span><span class="o">:</span> <span class="s2">"#hero-one"</span><span class="p">,</span>
      <span class="nx">title</span><span class="o">:</span> <span class="s2">"Notifications Served"</span><span class="p">,</span>
      <span class="nx">type</span><span class="o">:</span> <span class="s2">"max"</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">"Poll Time"</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">source</span><span class="o">:</span> <span class="s2">"http://localhost:4567/"</span><span class="p">,</span>
    <span class="nx">GaugeGadget</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">parent</span><span class="o">:</span> <span class="s2">"#hero-one"</span><span class="p">,</span>
      <span class="nx">title</span><span class="o">:</span> <span class="s2">"P1"</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">"&lt;just an informative label&gt;"</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">source</span><span class="o">:</span> <span class="s2">"&lt;graphite graph url, add &amp;format=json to querystring&gt;"</span><span class="p">,</span>
    <span class="s2">"&lt;widget type&gt;"</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">parent</span><span class="o">:</span> <span class="s2">"&lt;which will be placed in this element&gt;"</span><span class="p">,</span>
      <span class="nx">title</span><span class="o">:</span> <span class="s2">"&lt;title&gt;"</span>
      <span class="c1">// ... many other view opts ...</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>That's it basically. Advise the example for how your page should be
structured.</p>

<h2>
<a name="user-content-using-real-data" class="anchor" href="#using-real-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Using Real Data</h2>

<p>Lets see how to hook up a Graphite data source. You should first have an
idea of how your dashboard looks like in "standard" graphite dashboard.  </p>

<p>This means you can go ahead and build (or use) your dash with the
"standard" dashboard tool that Graphite provides.  </p>

<h2>
<a name="user-content-cross-domain" class="anchor" href="#cross-domain" aria-hidden="true"><span class="octicon octicon-link"></span></a>Cross-Domain</h2>

<p>In any case, if you don't have your dashboard on the Graphite domain,
you might have a cross-domain issue. In this case please set up your Chrome browser with <code>google-chrome --disable-web-security</code>.</p>

<h2>
<a name="user-content-graphite-data-api" class="anchor" href="#graphite-data-api" aria-hidden="true"><span class="octicon octicon-link"></span></a>Graphite Data API</h2>

<p>Then, given that you saved your Graphite dashboard named <code>resources</code>,
fetch this URL:</p>

<pre><code>http://&lt;graphite&gt;/dashboard/load/resources
</code></pre>

<p>You should see a JSON structure which contain these:</p>

<pre><code>/render?from=-2hours&amp;until=now&amp;width=400&amp;height=250&amp;target=some.metric&amp;title=my_metric
</code></pre>

<p>Use that query. Append <code>&amp;format=json</code> to it and you've got a
Graphene-ready URL!</p>

<pre><code>http://&lt;graphite&gt;/render?from=-2hours&amp;until=now&amp;width=400&amp;height=250&amp;target=some.metric&amp;title=my_metric&amp;format=json
</code></pre>

<h1>
<a name="user-content-autodiscovery" class="anchor" href="#autodiscovery" aria-hidden="true"><span class="octicon octicon-link"></span></a>Autodiscovery</h1>

<p>If all you really want is to migrate your Graphite "old" dash, a good
starting point would be with <code>discover()</code>, which will take all of your
timeseries and convert to a dashboard running Graphene TimeSeries:</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">g</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Graphene</span><span class="p">;</span>
<span class="nx">g</span><span class="p">.</span><span class="nx">discover</span><span class="p">(</span><span class="s1">'http://my.graphite.host.com'</span><span class="p">,</span> <span class="s1">'dev-pollers'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">url</span><span class="p">){</span> <span class="k">return</span> <span class="s2">"#dashboard"</span><span class="p">;</span> <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">description</span><span class="p">){</span>
  <span class="nx">g</span><span class="p">.</span><span class="nx">build</span><span class="p">(</span><span class="nx">description</span><span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">description</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

<p>You should specify <code>graphite host</code>, <code>dashboard name</code>, a <code>parent
specifier</code> which is responsible to spit out the next graph parent, and a
<code>result callback</code>.</p>

<p>You can also use the <code>description</code> result as a starting point for
building a more elaborate dashboard.</p>

<p>Check out an example at <code>/examples/dashboard-autodiscover.html</code></p>

<h1>
<a name="user-content-i-want-more" class="anchor" href="#i-want-more" aria-hidden="true"><span class="octicon octicon-link"></span></a>I Want More!</h1>

<p>Since Graphene is really a Backbone application (View, and Model, no
Controller here), you should be aware that your data is fetched to a
Model, munged on, and 'broadcasted' to interested parties (such as widgets).  </p>

<p>This means you can take a look at the Model, and be able to configure it
to your own needs. One example is specifying a <code>refresh_interval</code>.   </p>

<p>It wouldn't make sense to poll on your Graphite backend frequently, if the
data is updated slowly; turn <code>refresh_interval</code> up a notch.</p>

<h2>
<a name="user-content-extra-view-options" class="anchor" href="#extra-view-options" aria-hidden="true"><span class="octicon octicon-link"></span></a>Extra View options</h2>

<p>You can drop any of the below options in the builder's dashboard
description.</p>

<h3>
<a name="user-content-gaugelabel" class="anchor" href="#gaugelabel" aria-hidden="true"><span class="octicon octicon-link"></span></a>GaugeLabel</h3>

<ul class="task-list">
<li>
<code>unit</code> - unit to display, example "km", or "req/s"</li>
<li>
<code>title</code> - the gauge title</li>
<li>
<code>type</code> - how should data get aggregated?

<ul class="task-list">
<li>
<code>max</code> picks the largest value in the set of datapoints,</li>
<li>
<code>min</code> picks the smallest value in the set of datapoints,</li>
<li>
<code>current</code> picks the newest value in the set of datapoints,</li>
<li>null or no setting picks the first value in the set.</li>
</ul>
</li>
<li>
<code>value_format</code> - you can specify a value formatter (see d3)</li>
</ul><h3>
<a name="user-content-gaugegadget" class="anchor" href="#gaugegadget" aria-hidden="true"><span class="octicon octicon-link"></span></a>GaugeGadget</h3>

<ul class="task-list">
<li>
<code>title</code> - again, gauge title</li>
<li>
<code>type</code> - same as GaugeLabel</li>
<li>
<code>value_format</code> - value format</li>
<li>
<code>from</code> - start value of the gauge</li>
<li>
<code>to</code> - end value of the gauge</li>
</ul><h3>
<a name="user-content-timeseries" class="anchor" href="#timeseries" aria-hidden="true"><span class="octicon octicon-link"></span></a>TimeSeries</h3>

<ul class="task-list">
<li>
<code>line_height</code> - visuals, default 16</li>
<li>
<code>animate_ms</code> - new data animation in</li>
<li>
<code>num_labels</code> - max labels to display at the bottom</li>
<li>
<code>sort_labels</code> - order labels will be sorted</li>
<li>
<code>display_verticals</code> - display vertical ticks (eww!)</li>
<li>
<code>width</code> - box width</li>
<li>
<code>height</code> - box height</li>
<li>
<code>padding</code> - the kind of padding you need</li>
<li>
<code>title</code> - box title</li>
<li>
<code>label_formatter</code> - and a formatter, as before.</li>
<li>
<code>ymax</code> - the max value for the Y axis. If not specified and the URL has a yMax parameter, the value will be taken from the URL. Otherwise, this option will have precedence.</li>
<li>
<code>ymin</code> - the min value for the Y axis. </li>
</ul><h1>
<a name="user-content-visuals" class="anchor" href="#visuals" aria-hidden="true"><span class="octicon octicon-link"></span></a>Visuals</h1>

<p>Good news, other than problems with managing TONS of data points, I avoided using common graphing libraries because it's kinda hard to fit to how they see the world in terms of styling.  </p>

<p>Here you'll be able to just style with CSS. Most graph elements are SVG,
and you already have a good example of a high-contrast styling that I
use.  </p>

<p>Futher SVG is vector graphics. Try stretching up your dashboard, and
you'll find the quality of render isn't affected.</p>

<p>Applying just common CSS rules should give you everything that you need.</p>

<h2>
<a name="user-content-colors" class="anchor" href="#colors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Colors</h2>

<p>A good thing to think about is colors in your graph. In a time series,
you'd want each graph to appear distinct from the other, but still keep
a general notion of style (relate to the previous one).<br>
To do that, I've generated colors based on HSL, taking the next color on
the wheel serially, and keeping a good distance for a good contrast.<br>
For more detail, see <code>/tools</code></p>

<h1>
<a name="user-content-roadmap" class="anchor" href="#roadmap" aria-hidden="true"><span class="octicon octicon-link"></span></a>Roadmap</h1>

<p>These significant features will happen in the following weeks:</p>

<ul class="task-list">
<li>Visual hints. Lower/upper threshold options for TimeSeries. Once a
value passes above/below these, the Graph will give a visual cue
(flashing, heartbeat)</li>
<li>RSS widget. Include a stream of events using an RSS feed; provide
regex rules which cause RSS entries to be included, or be classified
as various levels of alerts. The goal is to be able to incorporate
source control history (GitHub events), and alert feeds from other systems.</li>
</ul><h1>
<a name="user-content-thanks" class="anchor" href="#thanks" aria-hidden="true"><span class="octicon octicon-link"></span></a>Thanks!</h1>

<p>I'd like to thank (chronological order):</p>

<ul class="task-list">
<li>Mike Bostock - for D3 itself, its awesome!. I found myself experimenting hours upon hours with it,
but not caring about the time flying by at all.</li>
<li>Tomer Doron (tomerd) - for the awesome D3 gauge gadget example which I've
customized and included here.</li>
<li>Chris Mytton (hecticjeff) - contributions</li>
<li>Michael Garski (mgarski) - contributions</li>
<li>dcartoon - JSONP cross domain support</li>
<li>Sean Kilgore (logikal) - contributions</li>
<li>arctanb - contributions</li>
<li>Dennis van der Vliet (dennisvdvliet) - bar graphs and other
contributions</li>
<li>cognusion - contributions</li>
<li>David Fisher (tibbon) - README fixes</li>
<li>Jean-Louis Giordano (Jell) - contributions</li>
<li>Michael Lavrisha (vrish88)- "current" gauge type</li>
<li>EButlerIV - contributions</li>
<li>David CHAU (davidchau) - contributions</li>
<li>Phil Cohen (phlipper) - contributions</li>
</ul><h1>
<a name="user-content-contributing" class="anchor" href="#contributing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contributing</h1>

<p>Fork, implement, add tests, pull request, get my everlasting thanks and a respectable place here :).</p>

<h1>
<a name="user-content-copyright" class="anchor" href="#copyright" aria-hidden="true"><span class="octicon octicon-link"></span></a>Copyright</h1>

<p>Copyright (c) 2012 <a href="http://gplus.to/dotan">Dotan Nahum</a> <a href="http://twitter.com/jondot">@jondot</a>. See MIT-LICENSE for further details.</p></article></div>
<div class="announce instapaper_body md" data-path="README.md" id="readme"><article class="markdown-body entry-content" itemprop="mainContentOfPage"><h1>
<a name="user-content-critical-" class="anchor" href="#critical-" aria-hidden="true"><span class="octicon octicon-link"></span></a>critical <a href="https://travis-ci.org/addyosmani/critical"><img src="https://camo.githubusercontent.com/af15ea4d486afd473019eefb04a865e6398c9646/68747470733a2f2f7472617669732d63692e6f72672f616464796f736d616e692f637269746963616c2e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/addyosmani/critical.svg?branch=master" style="max-width:100%;"></a>
</h1>

<p><a href="https://camo.githubusercontent.com/b4ecb54a743937e267790244e81901bbecd55f2d/687474703a2f2f692e696d6775722e636f6d2f6c417a6d4244322e706e67" target="_blank"><img src="https://camo.githubusercontent.com/b4ecb54a743937e267790244e81901bbecd55f2d/687474703a2f2f692e696d6775722e636f6d2f6c417a6d4244322e706e67" alt="" data-canonical-src="http://i.imgur.com/lAzmBD2.png" style="max-width:100%;"></a></p>

<p>Critical extracts &amp; inlines critical-path (above-the-fold) CSS from HTML</p>

<h2>
<a name="user-content-install" class="anchor" href="#install" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install</h2>

<div class="highlight highlight-sh"><pre><span class="nv">$ </span>npm install --save critical
</pre></div>

<h2>
<a name="user-content-demo-projects" class="anchor" href="#demo-projects" aria-hidden="true"><span class="octicon octicon-link"></span></a>Demo projects</h2>

<ul class="task-list">
<li>
<a href="https://github.com/addyosmani/critical-path-css-demo">Optimize a basic page with Gulp</a> with a <a href="https://github.com/addyosmani/critical-path-css-demo#tutorial">tutorial</a>
</li>
<li><a href="https://github.com/addyosmani/critical-path-angular-demo">Optimize an Angular boilerplate with Gulp</a></li>
<li><a href="https://github.com/addyosmani/critical-css-weather-app">Optimize a Weather app with Gulp</a></li>
</ul><h2>
<a name="user-content-usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>Include:</p>

<div class="highlight highlight-js"><pre><span class="kd">var</span> <span class="nx">critical</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'critical'</span><span class="p">);</span>
</pre></div>

<h3>
<a name="user-content-generate-and-inline-critical-path-css" class="anchor" href="#generate-and-inline-critical-path-css" aria-hidden="true"><span class="octicon octicon-link"></span></a>Generate and inline critical-path CSS</h3>

<div class="highlight highlight-js"><pre><span class="nx">critical</span><span class="p">.</span><span class="nx">generateInline</span><span class="p">({</span>
    <span class="c1">// Your base directory</span>
    <span class="nx">base</span><span class="o">:</span> <span class="s1">'dist/'</span><span class="p">,</span>

    <span class="c1">// HTML source</span>
    <span class="nx">src</span><span class="o">:</span> <span class="s1">'index.html'</span><span class="p">,</span>

    <span class="c1">// Your CSS Files (optional)</span>
    <span class="nx">css</span><span class="o">:</span> <span class="p">[</span><span class="s1">'dist/styles/main.css'</span><span class="p">],</span>

    <span class="c1">// Viewport width</span>
    <span class="nx">width</span><span class="o">:</span> <span class="mi">320</span><span class="p">,</span>

    <span class="c1">// Viewport height</span>
    <span class="nx">height</span><span class="o">:</span> <span class="mi">480</span><span class="p">,</span>

    <span class="c1">// Target for final HTML output</span>
    <span class="nx">htmlTarget</span><span class="o">:</span> <span class="s1">'index-critical.html'</span><span class="p">,</span>

    <span class="c1">// Target for generated critical-path CSS (which we inline)</span>
    <span class="nx">styleTarget</span><span class="o">:</span> <span class="s1">'styles/main.css'</span><span class="p">,</span>

    <span class="c1">// Minify critical-path CSS when inlining</span>
    <span class="nx">minify</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">});</span>
</pre></div>

<h3>
<a name="user-content-generate-critical-path-css" class="anchor" href="#generate-critical-path-css" aria-hidden="true"><span class="octicon octicon-link"></span></a>Generate critical-path CSS</h3>

<p>Basic usage:</p>

<div class="highlight highlight-js"><pre><span class="nx">critical</span><span class="p">.</span><span class="nx">generate</span><span class="p">({</span>
    <span class="nx">base</span><span class="o">:</span> <span class="s1">'test/'</span><span class="p">,</span>
    <span class="nx">src</span><span class="o">:</span> <span class="s1">'index.html'</span><span class="p">,</span>
    <span class="nx">dest</span><span class="o">:</span> <span class="s1">'styles/main.css'</span><span class="p">,</span>
    <span class="nx">width</span><span class="o">:</span> <span class="mi">320</span><span class="p">,</span>
    <span class="nx">height</span><span class="o">:</span> <span class="mi">480</span>
<span class="p">});</span>
</pre></div>

<p>Generate and minify critical-path CSS:</p>

<div class="highlight highlight-js"><pre><span class="nx">critical</span><span class="p">.</span><span class="nx">generate</span><span class="p">({</span>
    <span class="nx">base</span><span class="o">:</span> <span class="s1">'test/'</span><span class="p">,</span>
    <span class="nx">src</span><span class="o">:</span> <span class="s1">'index.html'</span><span class="p">,</span>
    <span class="nx">dest</span><span class="o">:</span> <span class="s1">'styles/styles.min.css'</span><span class="p">,</span>
    <span class="nx">minify</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">width</span><span class="o">:</span> <span class="mi">320</span><span class="p">,</span>
    <span class="nx">height</span><span class="o">:</span> <span class="mi">480</span>
<span class="p">});</span>
</pre></div>

<p>Generate and return output via a callback:</p>

<div class="highlight highlight-js"><pre><span class="nx">critical</span><span class="p">.</span><span class="nx">generate</span><span class="p">({</span>
    <span class="nx">base</span><span class="o">:</span> <span class="s1">'test/'</span><span class="p">,</span>
    <span class="nx">src</span><span class="o">:</span> <span class="s1">'index.html'</span><span class="p">,</span>
    <span class="nx">width</span><span class="o">:</span> <span class="mi">320</span><span class="p">,</span>
    <span class="nx">height</span><span class="o">:</span> <span class="mi">480</span>
<span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">output</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// You now have critical-path CSS</span>
    <span class="c1">// Works with and without dest specified</span>
<span class="p">});</span>
</pre></div>

<h3>
<a name="user-content-inline-style--critical-css-from-generation" class="anchor" href="#inline-style--critical-css-from-generation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Inline <code>&lt;style&gt;</code> / critical CSS from generation</h3>

<p>Basic usage:</p>

<div class="highlight highlight-js"><pre><span class="nx">critical</span><span class="p">.</span><span class="nx">inline</span><span class="p">({</span>
    <span class="nx">base</span><span class="o">:</span> <span class="s1">'test/'</span><span class="p">,</span>
    <span class="nx">src</span><span class="o">:</span> <span class="s1">'index-critical.html'</span><span class="p">,</span>
    <span class="nx">dest</span><span class="o">:</span> <span class="s1">'inlined.html'</span>
<span class="p">});</span>
</pre></div>

<p>Minify and inline stylesheets:</p>

<div class="highlight highlight-js"><pre><span class="nx">critical</span><span class="p">.</span><span class="nx">inline</span><span class="p">({</span>
    <span class="nx">base</span><span class="o">:</span> <span class="s1">'test/'</span><span class="p">,</span>
    <span class="nx">src</span><span class="o">:</span> <span class="s1">'index-critical.html'</span><span class="p">,</span>
    <span class="nx">dest</span><span class="o">:</span> <span class="s1">'inlined-minified.html'</span><span class="p">,</span>
    <span class="nx">minify</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">});</span>
</pre></div>

<p>Inline and return output via a callback:</p>

<div class="highlight highlight-js"><pre><span class="nx">critical</span><span class="p">.</span><span class="nx">inline</span><span class="p">({</span>
    <span class="nx">base</span><span class="o">:</span> <span class="s1">'test/'</span><span class="p">,</span>
    <span class="nx">src</span><span class="o">:</span> <span class="s1">'index-critical.html'</span>
<span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">output</span><span class="p">){</span>
    <span class="c1">// You now have HTML with inlined critical-path CSS</span>
    <span class="c1">// Works with and without dest specified</span>
<span class="p">});</span>
</pre></div>

<h3>
<a name="user-content-options" class="anchor" href="#options" aria-hidden="true"><span class="octicon octicon-link"></span></a>Options</h3>

<table>
<thead><tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr>
<td>base</td>
<td><code>string</code></td>
<td>Base directory in which the source and destination are to be written</td>
</tr>
<tr>
<td>src</td>
<td><code>string</code></td>
<td>Location of the HTML source to be operated against</td>
</tr>
<tr>
<td>dest</td>
<td><code>string</code></td>
<td>Location of where to save the output of an operation</td>
</tr>
<tr>
<td>width</td>
<td><code>integer</code></td>
<td>(Generation only) Width of the target viewport</td>
</tr>
<tr>
<td>height</td>
<td><code>integer</code></td>
<td>(Generation only) Height of the target viewport</td>
</tr>
<tr>
<td>minify</td>
<td><code>boolean</code></td>
<td>Enable minification of CSS output</td>
</tr>
<tr>
<td>styleTarget</td>
<td><code>string</code></td>
<td>(<code>generateInline</code> only) Destination for critical-path styles</td>
</tr>
<tr>
<td>htmlTarget</td>
<td><code>string</code></td>
<td>(<code>generateInline</code> only) Destination for (critical-path CSS) style-inlined HTML</td>
</tr>
<tr>
<td>maxImageFileSize</td>
<td><code>integer</code></td>
<td>Sets a max file size (in bytes) for base64 inlined images</td>
</tr>
</tbody>
</table><h2>
<a name="user-content-why" class="anchor" href="#why" aria-hidden="true"><span class="octicon octicon-link"></span></a>Why?</h2>

<h3>
<a name="user-content-why-is-critical-path-css-important" class="anchor" href="#why-is-critical-path-css-important" aria-hidden="true"><span class="octicon octicon-link"></span></a>Why is critical-path CSS important?</h3>

<blockquote>
<p>CSS is required to construct the render tree for your pages and JavaScript
will often block on CSS during initial construction of the page.
You should ensure that any non-essential CSS is marked as non-critical
(e.g. print and other media queries), and that the amount of critical CSS
and the time to deliver it is as small as possible.</p>
</blockquote>

<h3>
<a name="user-content-why-should-critical-path-css-be-inlined" class="anchor" href="#why-should-critical-path-css-be-inlined" aria-hidden="true"><span class="octicon octicon-link"></span></a>Why should critical-path CSS be inlined?</h3>

<blockquote>
<p>For best performance, you may want to consider inlining the critical CSS
directly into the HTML document. This eliminates additional roundtrips
in the critical path and if done correctly can be used to deliver a
“one roundtrip” critical path length where only the HTML is a blocking resource.</p>
</blockquote>

<h2>
<a name="user-content-faq" class="anchor" href="#faq" aria-hidden="true"><span class="octicon octicon-link"></span></a>FAQ</h2>

<h3>
<a name="user-content-are-there-any-sample-projects-available-using-critical" class="anchor" href="#are-there-any-sample-projects-available-using-critical" aria-hidden="true"><span class="octicon octicon-link"></span></a>Are there any sample projects available using Critical?</h3>

<p>Why, yes!. Take a look at <a href="https://github.com/addyosmani/critical-path-css-demo">this</a> Gulp project
which demonstrates using Critical to generate and inline critical-path CSS. It also includes a mini-tutorial
that walks through how to use it in a simple webapp.</p>

<h3>
<a name="user-content-when-should-i-just-use-penthouse-directly" class="anchor" href="#when-should-i-just-use-penthouse-directly" aria-hidden="true"><span class="octicon octicon-link"></span></a>When should I just use Penthouse directly?</h3>

<p>The main differences between Critical and <a href="https://github.com/pocketjoso/penthouse">Penthouse</a>, a module we
use, are:</p>

<ul class="task-list">
<li>Critical will automatically extract stylesheets from your HTML from which to generate critical-path CSS from,
whilst other modules generally require you to specify this upfront.</li>
<li>Critical provides methods for inlining critical-path CSS (a common logical next-step once your CSS is generated)</li>
<li>Since we tackle both generation and inlining, we're able to abstract away some of the ugly boilerplate otherwise
involved in tackling these problems separately.</li>
</ul><p>That said, if your site or app has a large number of styles or styles which are being dynamically injected into
the DOM (sometimes common in Angular apps) I recommend using Penthouse directly. It will require you to supply
styles upfront, but this may provide a higher level of accuracy if you find Critical isn't serving your needs.</p>

<h3>
<a name="user-content-what-other-alternatives-to-critical-are-available" class="anchor" href="#what-other-alternatives-to-critical-are-available" aria-hidden="true"><span class="octicon octicon-link"></span></a>What other alternatives to Critical are available?</h3>

<p>FilamentGroup maintain a <a href="https://github.com/filamentgroup/criticalCSS">criticalCSS</a> node module, which
similar to <a href="https://github.com/pocketjoso/penthouse">Penthouse</a> will find and output the critical-path CSS for
your pages.</p>

<h3>
<a name="user-content-is-critical-stable-and-suitable-for-production-use" class="anchor" href="#is-critical-stable-and-suitable-for-production-use" aria-hidden="true"><span class="octicon octicon-link"></span></a>Is Critical stable and suitable for production use?</h3>

<p>Many of the current tools around critical-path CSS are in an experimental stage and are constantly striving
to improve. The same could be said of Critical. It hasn't been extensively tested on a ton of sites and it's
very possible something may well break. That said, we welcome you to try it out on your project and report
bugs if you find them.</p>

<h2>
<a name="user-content-can-i-contribute" class="anchor" href="#can-i-contribute" aria-hidden="true"><span class="octicon octicon-link"></span></a>Can I contribute?</h2>

<p>Of course. We appreciate all of our <a href="https://github.com/addyosmani/critical/graphs/contributors">contributors</a> and
welcome contributions to improve the project further. If you're uncertain whether an addition should be made, feel
free to open up an issue and we can discuss it.</p></article></div>
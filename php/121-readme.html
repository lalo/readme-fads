<div class="announce instapaper_body md" data-path="README.md" id="readme"><article class="markdown-body entry-content" itemprop="mainContentOfPage"><h1>
<a name="user-content-search-replace-db" class="anchor" href="#search-replace-db" aria-hidden="true"><span class="octicon octicon-link"></span></a>Search Replace DB</h1>

<p>This script was made to aid the process of migrating PHP and MySQL based websites. It has additional features for WordPress and Drupal but works for most other similar CMSes.</p>

<p>If you find a problem let us know in the issues area and if you can improve the code then please fork the repository and send us a pull request :)</p>

<h2>
<a name="user-content-warnings--limitations" class="anchor" href="#warnings--limitations" aria-hidden="true"><span class="octicon octicon-link"></span></a>Warnings &amp; Limitations</h2>

<ol class="task-list">
<li>Three character UTF8 seems to break in certain cases.</li>
<li>We can't test every possible case, though we do our best. Backups and verifications are important.</li>
<li>The license for this script is GPL v3 and no longer WTFPL. Please bear this in mind if contributing or branching.</li>
<li>You use this script at your own risk and we have no responsibility for any problems it may cause. Do backups.</li>
</ol><h2>
<a name="user-content-usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<ol class="task-list">
<li>Migrate all your website files</li>
<li>Upload the script folder to your web root or higher (eg. the same folder as <code>wp-config.php</code> or <code>wp-content</code>)</li>
<li>Browse to the script folder URL in your web browser</li>
<li>Fill in the fields as needed</li>
<li>Choose the <code>Dry run</code> button to do a dry run without searching/replacing</li>
</ol><h3>
<a name="user-content-cli-script" class="anchor" href="#cli-script" aria-hidden="true"><span class="octicon octicon-link"></span></a>CLI script</h3>

<pre><code>ARGS
    -h, --host
        Required. The hostname of the database server.
    -n, --name
        Required. Database name.
    -u, --user
        Required. Database user.
    -p, --pass
        Required. Database user's password.
    -s, --search
        String to search for or `preg_replace()` style
        regular expression.
    -r, --replace
        None empty string to replace search with or
        `preg_replace()` style replacement.
    -t, --tables
        If set only runs the script on the specified table, comma
        separate for multiple values.
    -i, --include-cols
        If set only runs the script on the specified columns, comma
        separate for multiple values.
    -x, --exclude-cols
        If set excludes the specified columns, comma separate for
        multiple values.
    -g, --regex [no value]
        Treats value for -s or --search as a regular expression and
        -r or --replace as a regular expression replacement.
    -l, --pagesize
        How rows to fetch at a time from a table.
    -z, --dry-run [no value]
        Prevents any updates happening so you can preview the number
        of changes to be made
    -e, --alter-engine
        Changes the database table to the specified database engine
        eg. InnoDB or MyISAM. If specified search/replace arguments
        are ignored. They will not be run simultaneously.
    -a, --alter-collation
        Changes the database table to the specified collation
        eg. utf8_unicode_ci. If specified search/replace arguments
        are ignored. They will not be run simultaneously.
    -v, --verbose [true|false]
        Defaults to true, can be set to false to run script silently.
    --help
        Displays this help message ;)
</code></pre>

<h2>
<a name="user-content-troubleshooting" class="anchor" href="#troubleshooting" aria-hidden="true"><span class="octicon octicon-link"></span></a>Troubleshooting</h2>

<h3>
<a name="user-content-i-get-a-popup-saying-there-was-an-ajax-error" class="anchor" href="#i-get-a-popup-saying-there-was-an-ajax-error" aria-hidden="true"><span class="octicon octicon-link"></span></a>I get a popup saying there was an AJAX error</h3>

<p>This happens occasionally and could be for a couple of reasons:</p>

<ul class="task-list">
<li>script was unable to set the timeout so PHP closed the connection before the table could be processed, this can happen on some server configurations</li>
<li>When using php-fpm (as you have with VVV) make sure that the socket is owned by the server user <code>chown www-data:www-data /var/run/php5-fpm.sock</code>
</li>
</ul></article></div>
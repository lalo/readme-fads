<div class="announce instapaper_body md" data-path="README.md" id="readme"><article class="markdown-body entry-content" itemprop="mainContentOfPage"><p><a href="https://travis-ci.org/creaktive/rainbarf" title="Build Status"><img src="https://camo.githubusercontent.com/aca7803d847f97e5544c92e6b70cf83f091cf5ea/68747470733a2f2f7472617669732d63692e6f72672f637265616b746976652f7261696e626172662e706e673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/creaktive/rainbarf.png?branch=master" style="max-width:100%;"></a></p>

<h1>
<a name="user-content-name" class="anchor" href="#name" aria-hidden="true"><span class="octicon octicon-link"></span></a>NAME</h1>

<p>rainbarf - CPU/RAM/battery stats chart bar for tmux (and GNU screen)</p>

<h1>
<a name="user-content-version" class="anchor" href="#version" aria-hidden="true"><span class="octicon octicon-link"></span></a>VERSION</h1>

<p>version 1.2</p>

<h1>
<a name="user-content-synopsis" class="anchor" href="#synopsis" aria-hidden="true"><span class="octicon octicon-link"></span></a>SYNOPSIS</h1>

<pre><code>rainbarf --tmux --width 40 --no-battery
</code></pre>

<h1>
<a name="user-content-description" class="anchor" href="#description" aria-hidden="true"><span class="octicon octicon-link"></span></a>DESCRIPTION</h1>

<p>Fancy resource usage charts to put into the <a href="http://tmux.sourceforge.net/">tmux</a> status line.
The CPU utilization history chart is tinted with the following colors to reflect the system memory allocation:</p>

<ul class="task-list">
<li>
<strong>green</strong>: free memory;</li>
<li>
<strong>yellow</strong>: active memory;</li>
<li>
<strong>blue</strong>: inactive memory;</li>
<li>
<strong>red</strong>: wired memory on <em>Mac OS X</em> / <em>FreeBSD</em>; "unaccounted" memory on <em>Linux</em>;</li>
<li>
<strong>cyan</strong>: cached memory on <em>Linux</em>, buf on <em>FreeBSD</em>.</li>
<li>
<strong>magenta</strong>: used swap memory.</li>
</ul><p>If available, battery charge is displayed on the right.</p>

<h1>
<a name="user-content-screenshots" class="anchor" href="#screenshots" aria-hidden="true"><span class="octicon octicon-link"></span></a>SCREENSHOTS</h1>

<h2>
<a name="user-content-iterm2-with-tmux-powerline-solarized-theme-and-terminus-font" class="anchor" href="#iterm2-with-tmux-powerline-solarized-theme-and-terminus-font" aria-hidden="true"><span class="octicon octicon-link"></span></a>iTerm2 with <a href="https://github.com/erikw/tmux-powerline">tmux-powerline</a>, Solarized theme and Terminus font</h2>

<pre><code>rainbarf --battery --remaining --rgb
</code></pre>

<p><a href="https://camo.githubusercontent.com/3717259cc0d9d0034f07a819ad20fc5d180e1b75/687474703a2f2f692e696d6775722e636f6d2f6d78747a3732562e706e673f31" target="_blank"><img src="https://camo.githubusercontent.com/3717259cc0d9d0034f07a819ad20fc5d180e1b75/687474703a2f2f692e696d6775722e636f6d2f6d78747a3732562e706e673f31" alt="Mac OS X screenshot" data-canonical-src="http://i.imgur.com/mxtz72V.png?1" style="max-width:100%;"></a></p>

<h2>
<a name="user-content-osx-terminal-with-tomorrow-night-theme-and-menlo-font" class="anchor" href="#osx-terminal-with-tomorrow-night-theme-and-menlo-font" aria-hidden="true"><span class="octicon octicon-link"></span></a>OSX Terminal with <a href="https://github.com/chriskempson/tomorrow-theme#tomorrow-night">Tomorrow Night</a> theme and Menlo font</h2>

<pre><code>rainbarf --battery --remaining --no-bright
</code></pre>

<p><a href="https://camo.githubusercontent.com/dd97e8dc90cd640d0b3edca4a0f284926357ccfc/687474703a2f2f692e696d6775722e636f6d2f6734774e6e526a2e706e673f31" target="_blank"><img src="https://camo.githubusercontent.com/dd97e8dc90cd640d0b3edca4a0f284926357ccfc/687474703a2f2f692e696d6775722e636f6d2f6734774e6e526a2e706e673f31" alt="Mac OS X screenshot, v2" data-canonical-src="http://i.imgur.com/g4wNnRj.png?1" style="max-width:100%;"></a></p>

<h2>
<a name="user-content-ubuntu-terminal-with-default-theme-and-monospace-font" class="anchor" href="#ubuntu-terminal-with-default-theme-and-monospace-font" aria-hidden="true"><span class="octicon octicon-link"></span></a>Ubuntu Terminal with default theme and Monospace font</h2>

<pre><code>rainbarf --battery --bolt --bright
</code></pre>

<p><a href="https://camo.githubusercontent.com/93d1a7b58f1c5a177d280a09777d102715d524fd/687474703a2f2f692e696d6775722e636f6d2f6b6749646552612e706e673f31" target="_blank"><img src="https://camo.githubusercontent.com/93d1a7b58f1c5a177d280a09777d102715d524fd/687474703a2f2f692e696d6775722e636f6d2f6b6749646552612e706e673f31" alt="Ubuntu screenshot" data-canonical-src="http://i.imgur.com/kgIdeRa.png?1" style="max-width:100%;"></a></p>

<h1>
<a name="user-content-usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>USAGE</h1>

<h2>
<a name="user-content-installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<ul class="task-list">
<li>
<p>Traditional way:</p>

<pre><code>perl Build.PL
./Build test
./Build install
</code></pre>
</li>
<li>
<p><a href="http://brew.sh/">Homebrew</a> way:</p>

<pre><code>brew install rainbarf
</code></pre>
</li>
<li>
<p><a href="http://www.macports.org/">MacPorts</a> way:</p>

<pre><code>port install rainbarf
</code></pre>
</li>
<li>
<p>CPAN way:</p>

<pre><code>cpan -i App::rainbarf
</code></pre>
</li>
<li>
<p>Modern Perl way:</p>

<pre><code>cpanm git://github.com/creaktive/rainbarf.git
</code></pre>
</li>
</ul><h2>
<a name="user-content-configuration" class="anchor" href="#configuration" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configuration</h2>

<p>Add the following line to your <code>~/.tmux.conf</code> file:</p>

<pre><code>set-option -g status-utf8 on
set -g status-right '#(rainbarf)'
</code></pre>

<p>Or, under <em>GNOME Terminal</em>:</p>

<pre><code>set-option -g status-utf8 on
set -g status-right '#(rainbarf --rgb)'
</code></pre>

<p>Reload the tmux config by running <code>tmux source-file ~/.tmux.conf</code>.</p>

<h1>
<a name="user-content-configuration-file" class="anchor" href="#configuration-file" aria-hidden="true"><span class="octicon octicon-link"></span></a>CONFIGURATION FILE</h1>

<p><code>~/.rainbarf.conf</code> can be used to persistently store <a href="#options">"OPTIONS"</a>:</p>

<pre><code># example configuration file
width=20   # widget width
bolt       # fancy charging character
remaining  # display remaining battery
rgb        # 256-colored palette
</code></pre>

<p><a href="#options">"OPTIONS"</a> specified via command line override that values.
Configuration file can be specified via <code>RAINBARF</code> environment variable:</p>

<pre><code>RAINBARF=~/.rainbarf.conf rainbarf
</code></pre>

<h1>
<a name="user-content-options" class="anchor" href="#options" aria-hidden="true"><span class="octicon octicon-link"></span></a>OPTIONS</h1>

<ul class="task-list">
<li>
<p><code>--help</code></p>

<p>This.</p>
</li>
<li>
<p><code>--[no]battery</code></p>

<p>Display the battery charge indicator.
Enabled by default.</p>
</li>
<li>
<p><code>--[no]remaining</code></p>

<p>Display the time remaining until the battery is fully charged/empty. See <a href="#caveat">"CAVEAT"</a>.
Disabled by default.</p>
</li>
<li>
<p><code>--[no]bolt</code></p>

<p>Display even fancier battery indicator <code>âš¡</code>.
Disabled by default.</p>
</li>
<li>
<p><code>--[no]bright</code></p>

<p>Tricky one. Disabled by default. See <a href="#caveat">"CAVEAT"</a>.</p>
</li>
<li>
<p><code>--[no]rgb</code></p>

<p>Use the <strong>RGB</strong> palette instead of the system colors.
Also disabled by default, for the same reasons as above.</p>
</li>
<li>
<p><code>--fg COLOR_NAME</code></p>

<p>Force chart foreground color.</p>
</li>
<li>
<p><code>--bg COLOR_NAME</code></p>

<p>Force chart background color.</p>
</li>
<li>
<p><code>--[no]loadavg</code></p>

<p>Use <a href="https://en.wikipedia.org/wiki/Load_(computing)">load average</a> metric instead of CPU utilization.
You might want to set the <code>--max</code> threshold since this is an absolute value and has varying ranges on different systems.
Disabled by default.</p>
</li>
<li>
<p><code>--[no]swap</code></p>

<p>Display the swap usage.
Used swap amount is added to the total amount, but the free swap amount is not!
Disabled by default.</p>
</li>
<li>
<p><code>--max NUMBER</code></p>

<p>Maximum <code>loadavg</code> you expect before rescaling the chart. Default is 1.</p>
</li>
<li>
<p><code>--order INDEXES</code></p>

<p>Specify the memory usage bar order.
The default is <code>fwaic</code> (free, wired, active, inactive &amp; cached).</p>
</li>
<li>
<p><code>--[no]tmux</code></p>

<p>Force <code>tmux</code> colors mode.
By default, <a href="https://metacpan.org/pod/rainbarf">rainbarf</a> detects automatically if it is being called from <code>tmux</code> or from the interactive shell.</p>
</li>
<li>
<p><code>--screen</code></p>

<p><a href="http://manpages.ubuntu.com/manpages/hardy/man1/screen.1.html">screen(1)</a> colors mode. <strong>Experimental</strong>. See <a href="#caveat">"CAVEAT"</a>.</p>
</li>
<li>
<p><code>--width NUMBER</code></p>

<p>Chart width. Default is 38, so both the chart and the battery indicator fit the <code>tmux</code> status line.
Higher values may require disabling the battery indicator or raising the <code>status-right-length</code> value in <code>~/.tmux.conf</code>.</p>
</li>
<li>
<p><code>--datfile FILENAME</code></p>

<p>Specify the file to log CPU stats to.
Default: <code>$HOME/.rainbarf.dat</code></p>
</li>
<li>
<p><code>--skip NUMBER</code></p>

<p>Do not write CPU stats if file already exists and is newer than this many seconds.
Useful if you refresh <code>tmux</code> status quite frequently.</p>
</li>
</ul><h1>
<a name="user-content-caveat" class="anchor" href="#caveat" aria-hidden="true"><span class="octicon octicon-link"></span></a>CAVEAT</h1>

<h2>
<a name="user-content-time-remaining" class="anchor" href="#time-remaining" aria-hidden="true"><span class="octicon octicon-link"></span></a>Time remaining</h2>

<p>If the <code>--remaining</code> option is present but you do not see the time in your status bar, you may need to increase the value of <code>status-right-length</code> to 48.</p>

<h2>
<a name="user-content-color-scheme" class="anchor" href="#color-scheme" aria-hidden="true"><span class="octicon octicon-link"></span></a>Color scheme</h2>

<p>If you only see the memory usage bars but no CPU utilization chart, that's because your terminal's color scheme need an explicit distinction between foreground and background colors.
For instance, "red on red background" will be displayed as a red block on such terminals.
Thus, you may need the ANSI <strong>bright</strong> attribute for greater contrast, or maybe consider switching to the 256-color palette.
There are some issues with that, though:</p>

<ol class="task-list">
<li>Other color schemes (notably, <a href="http://ethanschoonover.com/solarized">solarized</a>) have different meaning for the ANSI <strong>bright</strong> attribute.
So using it will result in a quite psychedelic appearance.
256-color pallette, activated by the <code>--rgb</code> flag, is unaffected by that.</li>
<li>The older versions of <a href="https://metacpan.org/pod/Term::ANSIColor">Term::ANSIColor</a> dependency do not recognize bright/RGB settings, falling back to the default behavior (plain 16 colors).
However, the whole <a href="https://metacpan.org/pod/Term::ANSIColor">Term::ANSIColor</a> is optional, it is only required to preview the effects of the <a href="#options">"OPTIONS"</a> via command line before actually editing the <code>~/.tmux.conf</code>.
That is, <code>rainbarf --bright --tmux</code> <strong>is guaranteed to work</strong> despite the outdated <a href="https://metacpan.org/pod/Term::ANSIColor">Term::ANSIColor</a>!</li>
</ol><p>Another option is skipping the system colors altogether and use the <strong>RGB</strong> palette (<code>rainbarf --rgb</code>).
This fixes the <em>issue 1</em>, but doesn't affect the <em>issue 2</em>.
It still looks better, though.</p>

<h2>
<a name="user-content-persistent-storage" class="anchor" href="#persistent-storage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Persistent storage</h2>

<p>CPU utilization stats are persistently stored in the <code>~/.rainbarf.dat</code> file.
Every <a href="https://metacpan.org/pod/rainbarf">rainbarf</a> execution will update and rotate that file.
Since <code>tmux</code> calls <a href="https://metacpan.org/pod/rainbarf">rainbarf</a> periodically (every 15 seconds, by default), the chart will display CPU utilization for the last ~9.5 minutes (15 * 38).
Thus, several <code>tmux</code> instances running simultaneously for the same user will result in a faster chart scrolling.</p>

<h2>
<a name="user-content-screen" class="anchor" href="#screen" aria-hidden="true"><span class="octicon octicon-link"></span></a>screen</h2>

<p>Stable <code>screen</code> version unfortunately has a broken UTF-8 handling specifically for the status bar.
Thus, I have only tested the <a href="https://metacpan.org/pod/rainbarf">rainbarf</a> with the variant from git://git.savannah.gnu.org/screen.git.
My <code>~/.screenrc</code> contents:</p>

<pre><code>backtick 1 15 15 rainbarf --bright --screen
hardstatus string "%1`"
hardstatus lastline
</code></pre>

<h1>
<a name="user-content-references" class="anchor" href="#references" aria-hidden="true"><span class="octicon octicon-link"></span></a>REFERENCES</h1>

<ul class="task-list">
<li>
<a href="http://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man1/top.1.html">top(1)</a> is used to get the CPU/RAM stats if no <code>/proc</code> filesystem is available.</li>
<li>
<a href="http://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man8/ioreg.8.html">ioreg(8)</a> is used to get the battery status on <em>Mac OS X</em>.</li>
<li>
<a href="http://www.tldp.org/howto/acpi-howto/usingacpi.html">ACPI</a> is used to get the battery status on <em>Linux</em>.</li>
<li>
<a href="https://github.com/Goles/Battery">Battery</a> was a source of inspiration.</li>
<li>
<a href="http://zachholman.com/spark/">Spark</a> was another source of inspiration.</li>
</ul><h1>
<a name="user-content-author" class="anchor" href="#author" aria-hidden="true"><span class="octicon octicon-link"></span></a>AUTHOR</h1>

<p>Stanislaw Pusep <a href="mailto:stas@sysd.org">stas@sysd.org</a></p>

<h1>
<a name="user-content-contributors" class="anchor" href="#contributors" aria-hidden="true"><span class="octicon octicon-link"></span></a>CONTRIBUTORS</h1>

<ul class="task-list">
<li><a href="https://github.com/cknadler">Chris Knadler</a></li>
<li><a href="https://github.com/hammacher">Clemens Hammacher</a></li>
<li><a href="https://github.com/henrikhodne">Henrik Hodne</a></li>
<li><a href="https://github.com/jh3">Joe Hassick</a></li>
<li><a href="https://github.com/jmatth">Josh Matthews</a></li>
<li><a href="https://github.com/sergeyromanov">Sergey Romanov</a></li>
<li><a href="https://github.com/takac">Tom Cammann</a></li>
<li><a href="https://github.com/tjormola">Tuomas Jormola</a></li>
</ul><h1>
<a name="user-content-copyright-and-license" class="anchor" href="#copyright-and-license" aria-hidden="true"><span class="octicon octicon-link"></span></a>COPYRIGHT AND LICENSE</h1>

<p>This software is copyright (c) 2014 by Stanislaw Pusep <a href="mailto:stas@sysd.org">stas@sysd.org</a>.</p>

<p>This is free software; you can redistribute it and/or modify it under
the same terms as the Perl 5 programming language system itself.</p></article></div>
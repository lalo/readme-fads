<div class="announce instapaper_body md" data-path="README.md" id="readme"><article class="markdown-body entry-content" itemprop="mainContentOfPage"><h1>
<a name="user-content-rails_best_practices" class="anchor" href="#rails_best_practices" aria-hidden="true"><span class="octicon octicon-link"></span></a>rails_best_practices</h1>

<p><a href="http://badge.fury.io/rb/rails_best_practices"><img src="https://camo.githubusercontent.com/cb22849e3a0f5388dc6f0a908fc93537acc85681/68747470733a2f2f62616467652e667572792e696f2f72622f7261696c735f626573745f7072616374696365732e706e67" alt="Gem Version" data-canonical-src="https://badge.fury.io/rb/rails_best_practices.png" style="max-width:100%;"></a>
<a href="http://travis-ci.org/railsbp/rails_best_practices"><img src="https://camo.githubusercontent.com/b96c0c0be2b9afc764f521fcf0a816ee668a78aa/68747470733a2f2f7365637572652e7472617669732d63692e6f72672f7261696c7362702f7261696c735f626573745f7072616374696365732e706e67" alt="Build Status" data-canonical-src="https://secure.travis-ci.org/railsbp/rails_best_practices.png" style="max-width:100%;"></a>
<a href="https://coveralls.io/r/railsbp/rails_best_practices"><img src="https://camo.githubusercontent.com/258a4f28e411fd66b122ca329fe261306c1b75a3/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f7261696c7362702f7261696c735f626573745f7072616374696365732f62616467652e706e673f6272616e63683d6d6173746572" alt="Coverage Status" data-canonical-src="https://coveralls.io/repos/railsbp/rails_best_practices/badge.png?branch=master" style="max-width:100%;"></a></p>

<p><a href="http://coderwall.com/flyerhzm"><img src="https://camo.githubusercontent.com/81047c774a659b7a85ef4e0b193930425ee6b009/687474703a2f2f6170692e636f64657277616c6c2e636f6d2f666c796572687a6d2f656e646f727365636f756e742e706e67" alt="Coderwall Endorse" data-canonical-src="http://api.coderwall.com/flyerhzm/endorsecount.png" style="max-width:100%;"></a>
<a href="https://pledgie.com/campaigns/12057"><img src="https://camo.githubusercontent.com/f34ce53eb4e073e9060479ddef146747aa062fbd/68747470733a2f2f706c65646769652e636f6d2f63616d706169676e732f31323035372e706e673f736b696e5f6e616d653d6368726f6d65" alt="Click here to lend your support to: rails best practices and make a donation at www.pledgie.com !" data-canonical-src="https://pledgie.com/campaigns/12057.png?skin_name=chrome" style="max-width:100%;"></a></p>

<p>rails_best_practices is a code metric tool to check the quality of rails codes.</p>

<p>it supports following ORM/ODMs:</p>

<ul class="task-list">
<li>activerecord</li>
<li>mongoid</li>
<li>mongomapper</li>
</ul><p>following template engines:</p>

<ul class="task-list">
<li>erb</li>
<li>haml</li>
<li>slim</li>
<li>rabl</li>
</ul><p>rails_best_practices works well only in ruby 1.9.3, 2.0.0, and 2.1.0 so far.  It is incompatible with ruby 1.8.</p>

<h2>
<a name="user-content-external-introduction" class="anchor" href="#external-introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>External Introduction</h2>

<p><a href="http://ruby5.envylabs.com/episodes/257-episode-253-march-9th-2012/stories/2253-rails_best_practices">Ruby5 - Episode #253</a></p>

<p><a href="http://railscasts.com/episodes/252-metrics-metrics-metrics">Railscasts - #252 Metrics Metrics Metrics</a></p>

<h2>
<a name="user-content-usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>At the root directory of rails app</p>

<pre><code>rails_best_practices .
</code></pre>

<p>or html output</p>

<pre><code>rails_best_practices -f html .
</code></pre>

<p>By default rails_best_practices will do parse codes in vendor, spec, test and features directories. </p>

<h3>
<a name="user-content-excluding-folders" class="anchor" href="#excluding-folders" aria-hidden="true"><span class="octicon octicon-link"></span></a>Excluding folders</h3>

<p>To exclude folder simply call it with -e or --exclude</p>

<pre><code>rails_best_practices -e "db/migrate" .
</code></pre>

<p>To exclude multiple folders, separate them with comma</p>

<pre><code>rails_best_practices -e "db/migrate,vendor" .
</code></pre>

<h3>
<a name="user-content-other-command-line-options" class="anchor" href="#other-command-line-options" aria-hidden="true"><span class="octicon octicon-link"></span></a>Other command line options</h3>

<p>To see full list of commandline options call:</p>

<pre><code>$ rails_best_practices -h

Usage: rails_best_practices [options]
    -d, --debug                      Debug mode
    -f, --format FORMAT              output format
        --without-color              only output plain text without color
        --with-textmate              open file by textmate in html format
        --with-sublime               open file by sublime in html format (requires https://github.com/asuth/subl-handler)
        --with-mvim                  open file by mvim in html format
        --with-github GITHUB_NAME    open file on github in html format. GITHUB_NAME is like railsbp/rails-bestpractices OR full URL to GitHub:FI repo
        --with-hg                    display hg commit and username, only support html format
        --with-git                   display git commit and username, only support html format
        --template TEMPLATE          customize erb template
        --output-file OUTPUT_FILE    output html file for the analyzing result
        --silent                     silent mode
        --vendor                     include vendor files
        --spec                       include spec files
        --test                       include test files
        --features                   include features files
    -x, --exclude PATTERNS           Don't analyze files matching a pattern
                                     (comma-separated regexp list)
    -o, --only PATTERNS              analyze files only matching a pattern
                                     (comma-separated regexp list)
    -g, --generate                   Generate configuration yaml
    -v, --version                    Show this version
    -h, --help                       Show this message
</code></pre>

<h2>
<a name="user-content-resources" class="anchor" href="#resources" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resources</h2>

<p>Homepage: <a href="http://rails-bestpractices.com">http://rails-bestpractices.com</a></p>

<p>Online Service: <a href="http://railsbp.com">http://railsbp.com</a></p>

<p>Github: <a href="http://github.com/railsbp/rails_best_practices">http://github.com/railsbp/rails_best_practices</a></p>

<p>RDoc: <a href="http://rdoc.rails-bestpractices.com">http://rdoc.rails-bestpractices.com</a></p>

<p>Team Blog <a href="http://rails-bestpractices.com/blog/posts">http://rails-bestpractices.com/blog/posts</a></p>

<p>Google Group: <a href="https://groups.google.com/group/rails_best_practices">https://groups.google.com/group/rails_best_practices</a></p>

<p>Wiki: <a href="http://github.com/railsbp/rails_best_practices/wiki">http://github.com/railsbp/rails_best_practices/wiki</a></p>

<p>Issue Tracker: <a href="http://github.com/railsbp/rails_best_practices/issues">http://github.com/railsbp/rails_best_practices/issues</a></p>

<h2>
<a name="user-content-install" class="anchor" href="#install" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install</h2>

<p>rails_best_practices gem is rewritten based on ripper instead of ruby_parser to support ruby 1.9 new syntax.</p>

<pre><code>gem install rails_best_practices
</code></pre>

<p>or add in Gemfile</p>

<pre><code>gem "rails_best_practices"
</code></pre>

<h4>
<a name="user-content---with-sublime" class="anchor" href="#--with-sublime" aria-hidden="true"><span class="octicon octicon-link"></span></a>--with-sublime</h4>

<p>Install <a href="https://github.com/asuth/subl-handler">https://github.com/asuth/subl-handler</a></p>

<h2>
<a name="user-content-issue" class="anchor" href="#issue" aria-hidden="true"><span class="octicon octicon-link"></span></a>Issue</h2>

<p>If you install the rails_best_practices with bundler-installed github-sourced gem, please use the following command instead.</p>

<pre><code>bundle exec rails_best_practices .
</code></pre>

<p>If you got NoMethodError or any syntax error, you should use debug mode to detect which file rails_best_practices is parsing and getting the error.</p>

<pre><code>rails_best_practices -d .
</code></pre>

<p>Then give me the error stack and the source code of the file that rails_best_practices is parsing error.</p>

<h2>
<a name="user-content-customize-configuration" class="anchor" href="#customize-configuration" aria-hidden="true"><span class="octicon octicon-link"></span></a>Customize Configuration</h2>

<p>First run</p>

<pre><code>rails_best_practices -g
</code></pre>

<p>to generate <code>rails_best_practices.yml</code> file.</p>

<p>Now you can customize this configuration file, the default configuration is as follows:</p>

<pre><code>AddModelVirtualAttributeCheck: { }
AlwaysAddDbIndexCheck: { }
#CheckSaveReturnValueCheck: { }
DefaultScopeIsEvilCheck: { }
DryBundlerInCapistranoCheck: { }
#HashSyntaxCheck: { }
IsolateSeedDataCheck: { }
KeepFindersOnTheirOwnModelCheck: { }
LawOfDemeterCheck: { }
#LongLineCheck: { max_line_length: 80 }
MoveCodeIntoControllerCheck: { }
MoveCodeIntoHelperCheck: { array_count: 3 }
MoveCodeIntoModelCheck: { use_count: 2 }
MoveFinderToNamedScopeCheck: { }
MoveModelLogicIntoModelCheck: { use_count: 4 }
NeedlessDeepNestingCheck: { nested_count: 2 }
NotRescueExceptionCheck: { }
NotUseDefaultRouteCheck: {  }
NotUseTimeAgoInWordsCheck: {}
OveruseRouteCustomizationsCheck: { customize_count: 3 }
ProtectMassAssignmentCheck: {}
RemoveEmptyHelpersCheck: {}
#RemoveTabCheck: {}
RemoveTrailingWhitespaceCheck: { }
RemoveUnusedMethodsInControllersCheck: { except_methods: [] }
RemoveUnusedMethodsInHelpersCheck: { except_methods: [] }
RemoveUnusedMethodsInModelsCheck: { except_methods: [] }
ReplaceComplexCreationWithFactoryMethodCheck: { attribute_assignment_count: 2 }
ReplaceInstanceVariableWithLocalVariableCheck: { }
RestrictAutoGeneratedRoutesCheck: { }
SimplifyRenderInControllersCheck: {}
SimplifyRenderInViewsCheck: {}
#UseBeforeFilterCheck: { customize_count: 2 }
UseModelAssociationCheck: { }
UseMultipartAlternativeAsContentTypeOfEmailCheck: {}
UseObserverCheck: { }
#UseParenthesesInMethodDefCheck: {}
UseQueryAttributeCheck: { }
UseSayWithTimeInMigrationsCheck: { }
UseScopeAccessCheck: { }
UseTurboSprocketsRails3Check: { }
</code></pre>

<p>You can remove or comment one review to disable it, and you can change the options.</p>

<p>You can apply the <code>ignored_files</code> option on any rule by giving a regexp or array of regexps describing the path of the files you don't want to be checked:</p>

<pre><code>DefaultScopeIsEvilCheck: { ignored_files: 'user\.rb' }
LongLineCheck: { max_line_length: 80, ignored_files: ['db/migrate', 'config/initializers'] }
</code></pre>

<h2>
<a name="user-content-implementation" class="anchor" href="#implementation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Implementation</h2>

<p>Move code from Controller to Model</p>

<ol class="task-list">
<li>Move finder to named_scope (rails2 only)</li>
<li>Use model association</li>
<li>Use scope access</li>
<li>Add model virtual attribute</li>
<li>Replace complex creation with factory method</li>
<li>Move model logic into the Model</li>
<li>Check return value of "save!"</li>
</ol><p>RESTful Conventions</p>

<ol class="task-list">
<li>Overuse route customizations</li>
<li>Needless deep nesting</li>
<li>Not use default route</li>
<li>Restrict auto-generated routes</li>
</ol><p>Model</p>

<ol class="task-list">
<li>Keep finders on their own model (rails2 only)</li>
<li>the law of demeter</li>
<li>Use observer</li>
<li>Use query attribute</li>
<li>Remove unused methods in models</li>
<li>Protect mass assignment</li>
</ol><p>Mailer</p>

<ol class="task-list">
<li>Use multipart/alternative as content_type of email</li>
</ol><p>Migration</p>

<ol class="task-list">
<li>Isolating seed data</li>
<li>Always add db index</li>
<li>Use say with time in migrations</li>
</ol><p>Controller</p>

<ol class="task-list">
<li>Use before_filter (disabled by default)</li>
<li>Simplify render in controllers</li>
<li>Remove unused methods in controllers</li>
</ol><p>Helper</p>

<ol class="task-list">
<li>Remove empty helpers</li>
<li>Remove unused methods in helpers</li>
</ol><p>View</p>

<ol class="task-list">
<li>Move code into controller</li>
<li>Move code into model</li>
<li>Move code into helper</li>
<li>Replace instance variable with local variable</li>
<li>Simplify render in views</li>
<li>Not use time_ago_in_words</li>
</ol><p>Deployment</p>

<ol class="task-list">
<li>Dry bundler in capistrano</li>
<li>Speed up assets precompile with turbo-sprockets-rails3</li>
</ol><p>Other</p>

<ol class="task-list">
<li>Remove trailing whitespace</li>
<li>Remove tab (disabled by default)</li>
<li>Hash syntax (disabled by default)</li>
<li>Use parentheses in method def (disabled by default)</li>
<li>Long line (disabled by default)</li>
<li>Not rescue exception</li>
</ol><h2>
<a name="user-content-write-your-own-check-list" class="anchor" href="#write-your-own-check-list" aria-hidden="true"><span class="octicon octicon-link"></span></a>Write Your Own Check List</h2>

<p>If you want to write your own check list (some check list only for your rails projects), please read this first, <a href="https://github.com/railsbp/rails_best_practices/wiki/How-to-write-your-own-check-list">How to write your own check list?</a></p>

<h2>
<a name="user-content-contribute" class="anchor" href="#contribute" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contribute</h2>

<p>If you want to add your rails best practices into the gem, please post your best practices on <a href="http://rails-bestpractices.com">http://rails-bestpractices.com</a></p>

<h2>
<a name="user-content-contact-us" class="anchor" href="#contact-us" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contact Us</h2>

<p>We provide rails consulting services, you can contact us by twitter or email.</p>

<p>Follow us on twitter: <a href="http://twitter.com/railsbp">http://twitter.com/railsbp</a></p>

<p>Send us email: <a href="mailto:team@railsbp.com">team@railsbp.com</a></p>

<p>Copyright © 2009 - 2013 Richard Huang (<a href="mailto:flyerhzm@gmail.com">flyerhzm@gmail.com</a>), released under the MIT license</p></article></div>
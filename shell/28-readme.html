<div class="announce instapaper_body md" data-path="README.md" id="readme"><article class="markdown-body entry-content" itemprop="mainContentOfPage"><h1>
<a name="user-content-deprecation-warning" class="anchor" href="#deprecation-warning" aria-hidden="true"><span class="octicon octicon-link"></span></a>DEPRECATION WARNING</h1>

<p>This project is in a maintenance mode and no future functionality is likely to be added. tmux-powerline, with all other powerline projects, is replaced by the new unifying <a href="https://github.com/Lokaltog/powerline">powerline</a>. However this project is still functional and can serve as a lightweight alternative for non-python users.</p>

<h1>
<a name="user-content-tmux-powerline" class="anchor" href="#tmux-powerline" aria-hidden="true"><span class="octicon octicon-link"></span></a>tmux-powerline</h1>

<p>This is a set of scripts for making a nice and dynamic tmux statusbar consisting of segments. This is much like <a href="https://github.com/Lokaltog/vim-powerline">Lokaltog/vim-powerline</a> but for tmux.</p>

<p>The following segments exists for now:</p>

<ul class="task-list">
<li>LAN &amp; WAN IP addresses.</li>
<li>Now Playing for MPD, Spotify (GNU/Linux native or wine, OS X), iTunes (OS X), Rhythmbox, Banshee, MOC, Audacious, Rdio (OS X), cmus, Pithos and Last.fm (last scrobbled track).</li>
<li>New mail count for GMail, Maildir, mbox, mailcheck, and Apple Mail.</li>
<li>GNU/Linux and Macintosh OS X battery status (uses <a href="https://github.com/richoH/dotfiles/blob/master/bin/battery">richo/dotfiles/bin/battery</a>).</li>
<li>Weather in Celsius, Fahrenheit and Kelvin using Yahoo Weather.</li>
<li>System load, cpu usage and uptime.</li>
<li>Git, SVN and Mercurial branch in CWD.</li>
<li>Date and time.</li>
<li>Hostname.</li>
<li>tmux info.</li>
<li>CWD in pane.</li>
<li>Current X keyboard layout.</li>
<li>Network download/upload speed.</li>
<li>Earthquake warnings.</li>
</ul><h1>
<a name="user-content-screenshots" class="anchor" href="#screenshots" aria-hidden="true"><span class="octicon octicon-link"></span></a>Screenshots</h1>

<p><strong>Full screenshot</strong></p>

<p><a href="img/full.png" target="_blank"><img src="img/full.png" alt="Full screenshot" style="max-width:100%;"></a></p>

<p><strong>left-status</strong></p>

<p>Current tmux session, window and pane, hostname and LAN &amp; WAN IP address.</p>

<p><a href="img/left-status.png" target="_blank"><img src="img/left-status.png" alt="left-status" style="max-width:100%;"></a></p>

<p><strong>right-status</strong></p>

<p>New mails, now playing, average load, weather, date and time.</p>

<p><a href="img/right-status.png" target="_blank"><img src="img/right-status.png" alt="right-status" style="max-width:100%;"></a></p>

<p>Now I've read my inbox so the mail segment disappears!</p>

<p><a href="img/right-status_no_mail.png" target="_blank"><img src="img/right-status_no_mail.png" alt="right-status, no mail" style="max-width:100%;"></a></p>

<p>After pausing the music there's no need for showing NP anymore. Also the weather has become much nicer!</p>

<p><a href="img/right-status_no_mpd.png" target="_blank"><img src="img/right-status_no_mpd.png" alt="right-status, no mpd" style="max-width:100%;"></a></p>

<p>Remaining battery.</p>

<p><a href="img/right-status_weather_battery.png" target="_blank"><img src="img/right-status_weather_battery.png" alt="right-status, weather and battery" style="max-width:100%;"></a></p>

<h1>
<a name="user-content-requirements" class="anchor" href="#requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Requirements</h1>

<p>Requirements for the lib to work are:</p>

<ul class="task-list">
<li>Recent tmux version</li>
<li>
<code>bash --version</code> &gt;= 3.2 (Does not have to be your default shell.)</li>
<li>A patched font. Follow instructions at <a href="https://github.com/Lokaltog/vim-powerline/tree/develop/fontpatcher">Lokaltog/vim-powerline/fontpatcher</a> or <a href="https://github.com/Lokaltog/vim-powerline/wiki/Patched-fonts">download</a> a new one. However you can use other substitute symbols as well; see <code>config.sh</code>.</li>
</ul><h2>
<a name="user-content-segment-requirements" class="anchor" href="#segment-requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Segment Requirements</h2>

<p>Requirements for some segments. You only need to fulfill the requirements for those segments you want to use.</p>

<ul class="task-list">
<li>
<code>wan_ip.sh</code>, <code>now_playing.sh</code> (last.fm), <code>weather_yahoo.sh</code>: curl, bc</li>
<li>
<code>now_playing.sh</code> (mpd) : <a href="http://sourceforge.net/projects/musicpd/files/libmpdclient/">libmpdclient</a>
</li>
<li>
<code>xkb_layout.sh</code>: X11, XKB</li>
<li>
<code>mailcount.sh</code> (gmail): wget, (mailcheck): <a href="http://packages.debian.org/sid/mailcheck">mailcheck</a>.</li>
<li>
<code>ifstat.sh</code>: ifstat (there is a simpler segment not using ifstat but samples /sys/class/net)</li>
<li>
<code>tmux_mem_cpu_load.sh</code>: <a href="https://github.com/thewtex/tmux-mem-cpu-load">tmux-mem-cpu-load</a>
</li>
<li>
<code>rainbarf.sh</code>: <a href="https://github.com/creaktive/rainbarf">rainbarf</a>
</li>
<li>
<code>weather.sh</code>: GNU <code>grep</code> with Perl regexp enabled (FreeBSD specific)</li>
</ul><h2>
<a name="user-content-os-x-specific-requirements" class="anchor" href="#os-x-specific-requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>OS X specific requirements</h2>

<p>The <code>grep</code> tool is outdated on OS X 10.8 Mountain Lion so you might have to upgrade it. Unfortunately the main homebrew repo
<a href="https://github.com/mxcl/homebrew/pull/3473">does not contain grep</a> so use the following command to get the lastest version.</p>

<div class="highlight highlight-bash"><pre>brew install https://raw.github.com/Homebrew/homebrew-dupes/master/grep.rb
</pre></div>

<p>or if you have heightened security set up, just tap the homebrew dupes and install grep</p>

<div class="highlight highlight-bash"><pre>brew tap homebrew/dupes
brew install homebrew/dupes/grep
</pre></div>

<h2>
<a name="user-content-freebsd-specific-requirements" class="anchor" href="#freebsd-specific-requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>FreeBSD specific requirements</h2>

<p>Preinstalled <code>grep</code> in FreeBSD doesn't support Perl regexp. Solution is rather simple -- you need to use <code>textproc/gnugrep</code> port instead. You also need to make sure, that it has support for PCRE and is compiled with <code>--enable-perl-regexp</code> flag.</p>

<h1>
<a name="user-content-installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h1>

<p>Start with checking out the repository with:</p>

<div class="highlight highlight-console"><pre><span class="gp">$</span> <span class="nb">cd</span> ~/some/path/
<span class="gp">$</span> git clone https://github.com/erikw/tmux-powerline.git
</pre></div>

<p>Now edit your <code>~/.tmux.conf</code> to use the scripts:</p>



<div class="highlight highlight-vim"><pre><span class="k">set</span><span class="p">-</span><span class="k">option</span> <span class="p">-</span><span class="k">g</span> status <span class="k">on</span>
<span class="k">set</span><span class="p">-</span><span class="k">option</span> <span class="p">-</span><span class="k">g</span> status<span class="p">-</span>interval <span class="m">2</span>
<span class="k">set</span><span class="p">-</span><span class="k">option</span> <span class="p">-</span><span class="k">g</span> status<span class="p">-</span>utf8 <span class="k">on</span>
<span class="k">set</span><span class="p">-</span><span class="k">option</span> <span class="p">-</span><span class="k">g</span> status<span class="p">-</span>justify <span class="s2">"centre"</span>
<span class="k">set</span><span class="p">-</span><span class="k">option</span> <span class="p">-</span><span class="k">g</span> status<span class="p">-</span><span class="k">left</span><span class="p">-</span>length <span class="m">60</span>
<span class="k">set</span><span class="p">-</span><span class="k">option</span> <span class="p">-</span><span class="k">g</span> status<span class="p">-</span><span class="k">right</span><span class="p">-</span>length <span class="m">90</span>
<span class="k">set</span><span class="p">-</span><span class="k">option</span> <span class="p">-</span><span class="k">g</span> status<span class="p">-</span><span class="k">left</span> <span class="s2">"#(~/path/to/tmux-powerline/powerline.sh left)"</span>
<span class="k">set</span><span class="p">-</span><span class="k">option</span> <span class="p">-</span><span class="k">g</span> status<span class="p">-</span><span class="k">right</span> <span class="s2">"#(~/path/to/tmux-powerline/powerline.sh right)"</span>
</pre></div>

<p>Set the maximum lengths to something that suits your configuration of segments and size of terminal (the maximum segments length will be handled better in the future).</p>

<p>The window list can be powerlineified if you'd like by adding the following line to the same file:</p>

<div class="highlight highlight-vim"><pre><span class="k">set</span><span class="p">-</span><span class="nb">window</span><span class="p">-</span><span class="k">option</span> <span class="p">-</span><span class="k">g</span> <span class="nb">window</span><span class="p">-</span>status<span class="p">-</span>current<span class="p">-</span>format <span class="s2">"#[fg=colour235, bg=colour27]⮀#[fg=colour255, bg=colour27] #I ⮁ #W #[fg=colour27, bg=colour235]⮀"</span>
</pre></div>

<p>You can toggle the visibility of the statusbars by adding the following lines:</p>

<div class="highlight highlight-vim"><pre>bind C<span class="p">-</span>[ run <span class="s1">'~/path/to/tmux-powerline/mute_powerline.sh left'</span>      # Mute <span class="k">left</span> statusbar.
bind C<span class="p">-</span>] run <span class="s1">'~/path/to/tmux-powerline/mute_powerline.sh right'</span>     # Mute <span class="k">right</span> statusbar.
</pre></div>

<p>Some segments e.g. cwd and cvs_branch needs to find the current working directory of the active pane. To achieve this we let tmux save the path each time the shell prompt is displayed. Put the line below in your <code>~/.bashrc</code> or where you define you PS1 variable. zsh users can put it in e.g. <code>~/.zshrc</code> and may change <code>PS1</code> to <code>PROMPT</code> (but that's not necessary).</p>

<div class="highlight highlight-bash"><pre><span class="nv">PS1</span><span class="o">=</span><span class="s2">"$PS1"</span><span class="s1">'$([ -n "$TMUX" ] &amp;&amp; tmux setenv TMUXPWD_$(tmux display -p "#D" | tr -d %) "$PWD")'</span>
</pre></div>

<h1>
<a name="user-content-configuration" class="anchor" href="#configuration" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configuration</h1>

<p>The default segments that are shown are defined in <code>themes/default.sh</code>. You will probably want to change those to fit your needs. To do so you can edit that file directly but preferable, for easier updating of the repo, you can make a copy and edit that one (or see how to use custom themes directory below). A palette of colors that can be used can be obtained by running the script <code>color_palette.sh</code>.</p>

<div class="highlight highlight-console"><pre><span class="gp">$</span> cp themes/default.sh themes/mytheme.sh
<span class="gp">$</span> <span class="nv">$EDITOR</span> themes/mytheme.sh
</pre></div>

<p>Now  generate a default configuration file by doing</p>

<div class="highlight highlight-console"><pre><span class="gp">$</span> ./generate_rc.sh
<span class="gp">$</span> mv ~/.tmux-powerlinerc.default ~/.tmux-powerlinerc
<span class="gp">$</span> <span class="nv">$EDITOR</span> ~/.tmux-powerlinerc
</pre></div>

<p>and change theme to use and values for segments you want to use. If you want to keep the repo checkout clean you can set custom segment and theme paths in the general section and then store your files outside the repo.</p>

<h1>
<a name="user-content-debugging" class="anchor" href="#debugging" aria-hidden="true"><span class="octicon octicon-link"></span></a>Debugging</h1>

<p>Some segments might not work on your system for various reasons such as missing programs or different versions not having the same options. To find out which segment is not working it may help to enable the debug setting in <code>~/.tmux-powerlinerc</code>. However this may not be enough to determine the error so you can inspect all executed bash commands (will be a long output) by doing</p>

<div class="highlight highlight-console"><pre><span class="gp">$</span> bash -x powerline.sh <span class="o">(</span>left<span class="p">|</span>right<span class="o">)</span>
</pre></div>

<p>To debug smaller portions of code, say if you think the problem lies in a specific segment, insert these lines at the top and bottom of the relevant code portions e.g. inside a function:</p>

<div class="highlight highlight-bash"><pre><span class="nb">set</span> -x
<span class="nb">exec </span>2&gt;/tmp/tmux-powerline.log
&lt;code to debug&gt;
<span class="nb">set</span> +x
</pre></div>

<p>and then inspect the outputs like</p>

<div class="highlight highlight-console"><pre><span class="go">less /tmp/tmux-powerline.log</span>
<span class="go">tail -f /tmp/tmux-powerline.log # or follow output like this.</span>
</pre></div>

<p>If you can not solve the problems you can post an <a href="https://github.com/erikw/tmux-powerline/issues?state=open">issue</a> and be sure to include relevant information about your system and script output (from bash -x) and/or screenshots if needed.  Be sure to search in the <a href="https://github.com/erikw/tmux-powerline/issues?page=1&amp;state=closed">resolved issues</a> section for similar problems you're experiencing before posting.</p>

<h2>
<a name="user-content-common-problems" class="anchor" href="#common-problems" aria-hidden="true"><span class="octicon octicon-link"></span></a>Common problems</h2>

<h3>
<a name="user-content-vcs_branch--pwd-is-not-updating" class="anchor" href="#vcs_branch--pwd-is-not-updating" aria-hidden="true"><span class="octicon octicon-link"></span></a>VCS_branch / PWD is not updating</h3>

<p>The issue is probably that the update of the current directory in the active pane is not updated correctly. Make sure that your PS1 or PROMPT variable actually contains the line from the installation step above by simply inspecting the output of <code>echo $PS1</code>. You might have placed the PS1 line in you shell configuration such that it is overwritten later. The simplest solution is to put it at the very end to make sure that nothing overwrites it. See <a href="https://github.com/erikw/tmux-powerline/issues/52">issue #52</a>.</p>

<h3>
<a name="user-content-nothing-is-displayed" class="anchor" href="#nothing-is-displayed" aria-hidden="true"><span class="octicon octicon-link"></span></a>Nothing is displayed</h3>

<p>You have edited <code>~/.tmux.conf</code> but no powerline is displayed. This might be because tmux is not aware of the changes so you have to restart your tmux session or reloaded that file by typing this on the command line (or in tmux command mode with <code>prefix :</code>)</p>

<div class="highlight highlight-console"><pre><span class="gp">$</span> tmux <span class="nb">source</span>-file ~/.tmux.conf
</pre></div>

<h3>
<a name="user-content-multiple-lines-in-bash-or-no-powerline-in-zsh-using-iterm-os-x" class="anchor" href="#multiple-lines-in-bash-or-no-powerline-in-zsh-using-iterm-os-x" aria-hidden="true"><span class="octicon octicon-link"></span></a>Multiple lines in bash or no powerline in zsh using iTerm (OS X)</h3>

<p>If your tmux looks like <a href="https://github.com/erikw/tmux-powerline/issues/125">this</a> then you may have to in iTerm uncheck [Unicode East Asian Ambiguous characters are wide] in Preferences -&gt; Settings -&gt; Advanced.</p>

<h1>
<a name="user-content-hacking" class="anchor" href="#hacking" aria-hidden="true"><span class="octicon octicon-link"></span></a>Hacking</h1>

<p>This project can only gain positively from contributions. Fork today and make your own enhancements and segments to share back! If you'd like, add your name and E-mail to AUTHORS before making a pull request so you can get some credit for your work :-)</p>

<h2>
<a name="user-content-how-to-make-a-segment" class="anchor" href="#how-to-make-a-segment" aria-hidden="true"><span class="octicon octicon-link"></span></a>How to make a segment</h2>

<p>If you want to (of course you do!) send a pull request for a cool segment you written make sure that it follows the style of existing segments, unless you have good reason for it. Each segment resides in the <code>segments/</code> directory with a descriptive and simple name. A segment must have at least one function and that is <code>run_segment</code> which is like the main function that is called from the tmux-powerline lib. What ever text is echoed out from this function to stdout is the text displayed in the tmux statusbar. If the segment at a certain point does not have anything to show, simply don't echo anything out and the segment will be hidden. A successful execution of the <code>run_segment</code> function should return an exit code of 0. If the segment failed to execute in a fatal way return a non-zero exit code so the user can pick up the error and fix it when debug mode is on (e.g. missing program that is needed for the segment).</p>

<p>Usage of helper function to organize the work of a segment is encourage and should be named in the format <code>__helper_func</code>. If a segment has settings it should have a function <code>generate_rc</code> which outputs default values of all settings and a short explanation of the setting and its values. Study e.g. <code>segments/now_playing.sh</code> to see how it is done. A segment having settings should typically call a helper function <code>__process_settings</code> as the first statement in <code>run_segment</code> that sets default values to the settings that has not been set by the user.</p>

<p>Also, don't use bash4 features as requiring bash4 complicates installation for OS X user quite a bit. Use tabs for indentation (<a href="https://github.com/erikw/tmux-powerline/pull/92">discussion</a>),</p></article></div>
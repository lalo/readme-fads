<div class="announce instapaper_body md" data-path="README.md" id="readme"><article class="markdown-body entry-content" itemprop="mainContentOfPage"><p align="center">
  <a href="https://camo.githubusercontent.com/a50c18ef20ae95a29d3be31cd43056ced1221bc9/687474703a2f2f627269616e676f6e7a616c657a2e6769746875622e696f2f6a71756572792e61646170746976652d6261636b67726f756e64732e6a732f66617669636f6e2e706e673f32" target="_blank"><img src="https://camo.githubusercontent.com/a50c18ef20ae95a29d3be31cd43056ced1221bc9/687474703a2f2f627269616e676f6e7a616c657a2e6769746875622e696f2f6a71756572792e61646170746976652d6261636b67726f756e64732e6a732f66617669636f6e2e706e673f32" data-canonical-src="http://briangonzalez.github.io/jquery.adaptive-backgrounds.js/favicon.png?2" style="max-width:100%;"></a></p>

<h2>
<a name="user-content-jqueryadaptive-backgroundsjs" class="anchor" href="#jqueryadaptive-backgroundsjs" aria-hidden="true"><span class="octicon octicon-link"></span></a>jquery.adaptive-backgrounds.js</h2>

<p><em>A simple jQuery plugin to extract the dominant color of an image and apply it to the background of its parent element.</em></p>

<p><strong><a href="http://briangonzalez.github.io/jquery.adaptive-backgrounds.js/">Check it out on the web!</a></strong></p>

<h2>
<a name="user-content-getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span class="octicon octicon-link"></span></a>Getting Started</h2>

<p>Simply include jQuery and the <strong><a href="https://raw2.github.com/briangonzalez/jquery.adaptive-backgrounds.js/master/src/jquery.adaptive-backgrounds.js">script</a></strong> in your page, then run the script like so:</p>

<div class="highlight highlight-javascript"><pre><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="nx">$</span><span class="p">.</span><span class="nx">adaptiveBackground</span><span class="p">.</span><span class="nx">run</span><span class="p">()</span>
<span class="p">});</span>
</pre></div>

<p>The script looks for image(s) with the <code>data-adaptive-background</code> attribute:</p>

<div class="highlight highlight-html"><pre><span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"/image.jpg"</span> <span class="na">data-adaptive-background=</span><span class="s">'1'</span><span class="nt">&gt;</span>
</pre></div>

<h3>
<a name="user-content-using-an-element-with-a-css-background-image" class="anchor" href="#using-an-element-with-a-css-background-image" aria-hidden="true"><span class="octicon octicon-link"></span></a>Using an element with a CSS background image</h3>

<p>Instead of using an <code>&lt;img&gt;</code> element nested inside of parent element, AB supports grabbing the dominant color of a background image of a standalone element, then applying the corresponding dominant color as the background color of said element.</p>

<p>Enable this functionality by adding a data property, <code>data-ab-css-background</code> to the element. See the example below:</p>

<div class="highlight highlight-html"><pre><span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">'background-image: url(/some-image.jpg)'</span> <span class="na">data-adaptive-background=</span><span class="s">'1'</span> <span class="na">data-ab-css-background=</span><span class="s">'1'</span><span class="nt">&gt;&lt;/div&gt;</span>
</pre></div>

<h2>
<a name="user-content-demo" class="anchor" href="#demo" aria-hidden="true"><span class="octicon octicon-link"></span></a>Demo</h2>

<p>Here's a little demo of how it works. (1) The page loads (2) the dominant background color of the image is extracted (3) said color is applied to parent of image. <em>Demo drastically slowed down to show effect</em>.
<a href="https://camo.githubusercontent.com/230ee3c86ec555c70063353e73896ef1fec629a2/68747470733a2f2f7261772e6769746875622e636f6d2f627269616e676f6e7a616c657a2f6a71756572792e61646170746976652d6261636b67726f756e642e6a732f6d61737465722f6d6973632f61622e676966" target="_blank"><img src="https://camo.githubusercontent.com/230ee3c86ec555c70063353e73896ef1fec629a2/68747470733a2f2f7261772e6769746875622e636f6d2f627269616e676f6e7a616c657a2f6a71756572792e61646170746976652d6261636b67726f756e642e6a732f6d61737465722f6d6973632f61622e676966" data-canonical-src="https://raw.github.com/briangonzalez/jquery.adaptive-background.js/master/misc/ab.gif" style="max-width:100%;"></a></p>

<h2>
<a name="user-content-api" class="anchor" href="#api" aria-hidden="true"><span class="octicon octicon-link"></span></a>API</h2>

<p>This plugin exposes one method:</p>

<ul class="task-list">
<li>
<strong>$.adaptiveBackground.run(opts)</strong> <em>arg: opts (Object)</em> an optional argument to be merged in with the defaults.</li>
</ul><h2>
<a name="user-content-default-options" class="anchor" href="#default-options" aria-hidden="true"><span class="octicon octicon-link"></span></a>Default Options</h2>

<ul class="task-list">
<li>
<strong>selector</strong> String <em>(default: <code>'img[data-adaptive-background="1"]'</code>)</em> a CSS selector which denotes which images to grab/process. Ideally, this selector would start with <em>img</em>, to ensure we only grab and try to process actual images.</li>
<li>
<strong>parent</strong> falsy <em>(default: <code>null</code>)</em> a CSS selector which denotes which parent to apply the background color to. By default, the color is applied to the parent one level up the DOM tree.</li>
<li>
<strong>normalizeTextColor</strong> boolean <em>(default: <code>false</code>)</em> option to normalize the color of the parent text if background color is too dark or too light</li>
<li>
<strong>normalizedTextColors</strong> Object Literal <em>(default: <code>{dark: '#000', light: '#fff'}</code>)</em> text colors used when background is either too dark/light</li>
</ul><p><strong>Example:</strong>
Call the <code>run</code> method, passing in any options you'd like to override.</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">defaults</span>      <span class="o">=</span> <span class="p">{</span>
  <span class="nx">selector</span><span class="o">:</span>             <span class="s1">'[data-adaptive-background="1"]'</span><span class="p">,</span>
  <span class="nx">parent</span><span class="o">:</span>               <span class="kc">null</span><span class="p">,</span>
  <span class="nx">exclude</span><span class="o">:</span>              <span class="p">[</span> <span class="s1">'rgb(0,0,0)'</span><span class="p">,</span> <span class="s1">'rgba(255,255,255)'</span> <span class="p">],</span>
  <span class="nx">normalizeTextColor</span><span class="o">:</span>   <span class="kc">false</span><span class="p">,</span>
  <span class="nx">normalizedTextColors</span><span class="o">:</span>  <span class="p">{</span>
    <span class="nx">light</span><span class="o">:</span>      <span class="s2">"#fff"</span><span class="p">,</span>
    <span class="nx">dark</span><span class="o">:</span>       <span class="s2">"#000"</span>
  <span class="p">},</span>
  <span class="nx">lumaClasses</span><span class="o">:</span>  <span class="p">{</span>
    <span class="nx">light</span><span class="o">:</span>      <span class="s2">"ab-light"</span><span class="p">,</span>
    <span class="nx">dark</span><span class="o">:</span>       <span class="s2">"ab-dark"</span>
  <span class="p">}</span>
<span class="p">};</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">adaptiveBackground</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="nx">defaults</span><span class="p">)</span>
</pre></div>

<h2>
<a name="user-content-events-emitted" class="anchor" href="#events-emitted" aria-hidden="true"><span class="octicon octicon-link"></span></a>Events Emitted</h2>

<ul class="task-list">
<li>
<strong>ab-color-found</strong> <a href="http://api.jquery.com/category/events/event-object/">Event</a> This event is fired when the dominant color of the image is found. The payload includes the dominant color as well as the color palette contained in the image.</li>
</ul><p><strong>Example:</strong>
Bind to the <code>ab-color-found</code> event like so:</p>

<div class="highlight highlight-javascript"><pre><span class="nx">$</span><span class="p">(</span><span class="s1">'img.my-image'</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">'ab-color-found'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">,</span><span class="nx">payload</span><span class="p">){</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">payload</span><span class="p">.</span><span class="nx">color</span><span class="p">);</span>   <span class="c1">// The dominant color in the image.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">payload</span><span class="p">.</span><span class="nx">palette</span><span class="p">);</span> <span class="c1">// The color palette found in the image.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">ev</span><span class="p">);</span>   <span class="c1">// The jQuery.Event object</span>
<span class="p">});</span>
</pre></div>

<h2>
<a name="user-content-success-callback" class="anchor" href="#success-callback" aria-hidden="true"><span class="octicon octicon-link"></span></a>Success Callback</h2>

<p>You may wish to supply a callback function which is called once the magic has been performed.</p>

<div class="highlight highlight-javascript"><pre><span class="nx">$</span><span class="p">.</span><span class="nx">adaptiveBackground</span><span class="p">.</span><span class="nx">run</span><span class="p">({</span>
  <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$img</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Success!'</span><span class="p">,</span> <span class="nx">$img</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>

<p>Note, this callback is called <em>once</em> for each image.</p>

<h2>
<a name="user-content-caveats" class="anchor" href="#caveats" aria-hidden="true"><span class="octicon octicon-link"></span></a>Caveats</h2>

<p>This plugin utlizes the <code>&lt;canvas&gt;</code> element and the <code>ImageData</code> object, and due to cross-site security limitations, the script will fail if one tries to extract the colors from an image not hosted on the current domain, <em>unless</em> the image allows for <a href="http://en.wikipedia.org/wiki/Cross-origin_resource_sharing">Cross Origin Resource Sharing</a>.</p>

<p><strong>Enabling CORS on S3</strong></p>

<p>To enable CORS for images hosted on S3 buckets, follow the Amazon guide <a href="http://docs.aws.amazon.com/AmazonS3/latest/UG/EditingBucketPermissions.html">here</a>; adding the following to the bucket's CORS configuration:</p>

<div class="highlight highlight-xml"><pre><span class="nt">&lt;CORSRule&gt;</span>
 <span class="nt">&lt;AllowedOrigin&gt;</span>*<span class="nt">&lt;/AllowedOrigin&gt;</span>
 <span class="nt">&lt;AllowedMethod&gt;</span>GET<span class="nt">&lt;/AllowedMethod&gt;</span>
<span class="nt">&lt;/CORSRule&gt;</span>
</pre></div>

<p>For all images, you can optionally also include a cross-origin attribute in your image. This is not absolutely necessary since the <code>anonymous</code> origin is set in the Javascript code, but kudos to you for being a super-developer.</p>

<div class="highlight highlight-html"><pre><span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"/image.jpg"</span> <span class="na">data-adaptive-background=</span><span class="s">'1'</span> <span class="na">cross-origin=</span><span class="s">"anonymous"</span><span class="nt">/&gt;</span>
</pre></div>

<h2>
<a name="user-content-credit" class="anchor" href="#credit" aria-hidden="true"><span class="octicon octicon-link"></span></a>Credit</h2>

<p>This plugin is built on top of a script called <a href="https://github.com/briangonzalez/rgbaster.js">RGBaster</a>.</p>

<h2>
<a name="user-content-author" class="anchor" href="#author" aria-hidden="true"><span class="octicon octicon-link"></span></a>Author</h2>

<table>
<thead><tr>
<th><a href="https://camo.githubusercontent.com/729922b68dca6ebae6c74ae69f39965a63ef51b4/687474703a2f2f67726176617461722e636f6d2f6176617461722f66363336336665316439616164623163336630376261373836376630653835343f733d373025354428687474703a2f2f747769747465722e636f6d2f627269616e6d676f6e7a616c657a" target="_blank"><img src="https://camo.githubusercontent.com/729922b68dca6ebae6c74ae69f39965a63ef51b4/687474703a2f2f67726176617461722e636f6d2f6176617461722f66363336336665316439616164623163336630376261373836376630653835343f733d373025354428687474703a2f2f747769747465722e636f6d2f627269616e6d676f6e7a616c657a" alt="twitter/brianmgonzalez" title="Follow @brianmgonzalez on Twitter" data-canonical-src="http://gravatar.com/avatar/f6363fe1d9aadb1c3f07ba7867f0e854?s=70%5D(http://twitter.com/brianmgonzalez" style="max-width:100%;"></a></th>
</tr></thead>
<tbody><tr>
<td><a href="http://briangonzalez.org">Brian Gonzalez</a></td>
</tr></tbody>
</table><h2>
<a name="user-content-license" class="anchor" href="#license" aria-hidden="true"><span class="octicon octicon-link"></span></a>License</h2>

<p>MIT, yo.</p></article></div>
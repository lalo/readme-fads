<div class="announce instapaper_body md" data-path="README.md" id="readme"><article class="markdown-body entry-content" itemprop="mainContentOfPage"><h1>
<a name="user-content-our-boxen" class="anchor" href="#our-boxen" aria-hidden="true"><span class="octicon octicon-link"></span></a>Our Boxen</h1>

<p>This is a template Boxen project designed for your organization to fork and
modify appropriately.
The Boxen rubygem and the Boxen puppet modules are only a framework for getting
things done.
This repository template is just a basic example of <em>how</em> to do things with them.</p>

<h2>
<a name="user-content-getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span class="octicon octicon-link"></span></a>Getting Started</h2>

<p>To give you a brief overview, we're going to:</p>

<ul class="task-list">
<li>Install dependencies (basically Xcode)</li>
<li>Bootstrap a boxen for your self/team/org/company</li>
<li>Then convert your local copy of that boxen to the post-bootstrapped version</li>
</ul><p>There are a few potential conflicts to keep in mind.
Boxen does its best not to get in the way of a dirty system,
but you should check into the following before attempting to install your
boxen on any machine (we do some checks before every Boxen run to try
and detect most of these and tell you anyway):</p>

<ul class="task-list">
<li>Boxen <strong>requires</strong> at least the Xcode Command Line Tools installed.</li>
<li>Boxen <strong>will not</strong> work with an existing rvm install.</li>
<li>Boxen <strong>may not</strong> play nice with a GitHub username that includes dash(-)</li>
<li>Boxen <strong>may not</strong> play nice with an existing rbenv install.</li>
<li>Boxen <strong>may not</strong> play nice with an existing chruby install.</li>
<li>Boxen <strong>may not</strong> play nice with an existing homebrew install.</li>
<li>Boxen <strong>may not</strong> play nice with an existing nvm install.</li>
<li>Boxen <strong>recommends</strong> installing the full Xcode.</li>
</ul><h3>
<a name="user-content-dependencies" class="anchor" href="#dependencies" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dependencies</h3>

<p><strong>Install the Xcode Command Lines Tools and/or full Xcode.</strong>
This will grant you the most predictable behavior in building apps like
MacVim.</p>

<p>How do you do it?</p>

<h4>
<a name="user-content-os-x-109-mavericks" class="anchor" href="#os-x-109-mavericks" aria-hidden="true"><span class="octicon octicon-link"></span></a>OS X 10.9 (Mavericks)</h4>

<p>If you are using <a href="https://github.com/boxen/boxen-web/commit/b26abd0d681129eba0b5f46ed43110d873d8fdc2"><code>b26abd0</code> of boxen-web</a>
or newer, it will be automatically installed as part of Boxen.
Otherwise, follow instructions below.</p>

<h4>
<a name="user-content-os-x--109" class="anchor" href="#os-x--109" aria-hidden="true"><span class="octicon octicon-link"></span></a>OS X &lt; 10.9</h4>

<ol class="task-list">
<li>Install Xcode from the Mac App Store.</li>
<li>Open Xcode.</li>
<li>Open the Preferences window (<code>Cmd-,</code>).</li>
<li>Go to the Downloads tab.</li>
<li>Install the Command Line Tools.</li>
</ol><h3>
<a name="user-content-bootstrapping" class="anchor" href="#bootstrapping" aria-hidden="true"><span class="octicon octicon-link"></span></a>Bootstrapping</h3>

<p>Create a <strong>new</strong> git repository somewhere on the internet.
It can be private or public -- it really doesn't matter.
If you're making a repository on GitHub, you <em>may not</em> want to fork this repo
to get started.
The reason for that is that you can't really make private forks of public
repositories easily.</p>

<p>Once you've done that, you can run the following to bootstrap
your boxen:</p>

<pre><code>sudo mkdir -p /opt/boxen
sudo chown ${USER}:staff /opt/boxen
git clone https://github.com/boxen/our-boxen /opt/boxen/repo
cd /opt/boxen/repo
git remote rm origin
git remote add origin &lt;the location of my new git repository&gt;
git push -u origin master
</code></pre>

<p>Now that your boxen is bootstrapped, you can run the following to
install the default configuration from this repo:</p>

<pre><code>cd /opt/boxen/repo
./script/boxen
</code></pre>

<h3>
<a name="user-content-distributing" class="anchor" href="#distributing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Distributing</h3>

<p>That's enough to get your boxen into a usable state on other machines,
usually.
From there, we recommend setting up
<a href="https://github.com/boxen/boxen-web">boxen-web</a>
as an easy way to automate letting other folks install your boxen.</p>

<p>If you <em>don't</em> want to use boxen-web, folks can get using your boxen like so:</p>

<pre><code>sudo mkdir -p /opt/boxen
sudo chown ${USER}:staff /opt/boxen
git clone &lt;location of my new git repository&gt; /opt/boxen/repo
cd /opt/boxen/repo
./script/boxen
</code></pre>

<p>Keep in mind this requires you to encrypt your hard drive by default.
If you do not want to do encrypt your hard drive, you can use the <code>--no-fde</code>.</p>

<pre><code>./script/boxen --no-fde
</code></pre>

<p>It should run successfully, and should tell you to source a shell script
in your environment.
For users without a bash or zsh config or a <code>~/.profile</code> file,
Boxen will create a shim for you that will work correctly.
If you do have a <code>~/.bashrc</code> or <code>~/.zshrc</code>, your shell will not use
<code>~/.profile</code> so you'll need to add a line like so at <em>the end of your config</em>:</p>

<div class="highlight highlight-sh"><pre><span class="o">[</span> -f /opt/boxen/env.sh <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">source</span> /opt/boxen/env.sh
</pre></div>

<p>Once your shell is ready, open a new tab/window in your Terminal
and you should be able to successfully run <code>boxen --env</code>.
If that runs cleanly, you're in good shape.</p>

<h2>
<a name="user-content-what-you-get" class="anchor" href="#what-you-get" aria-hidden="true"><span class="octicon octicon-link"></span></a>What You Get</h2>

<p>This template project provides the following by default:</p>

<ul class="task-list">
<li>Homebrew</li>
<li>Git</li>
<li>Hub</li>
<li>dnsmasq w/ .dev resolver for localhost</li>
<li>rbenv</li>
<li>Full Disk Encryption requirement</li>
<li>Node.js 0.6</li>
<li>Node.js 0.8</li>
<li>Node.js 0.10</li>
<li>Ruby 1.9.3</li>
<li>Ruby 2.0.0</li>
<li>Ruby 2.1.0</li>
<li>Ruby 2.1.1</li>
<li>ack</li>
<li>Findutils</li>
<li>GNU tar</li>
</ul><h2>
<a name="user-content-customizing" class="anchor" href="#customizing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Customizing</h2>

<p>You can always check out the number of existing modules we already
provide as optional installs under the
<a href="https://github.com/boxen">boxen organization</a>. These modules are all
tested to be compatible with Boxen. Use the <code>Puppetfile</code> to pull them
in dependencies automatically whenever <code>boxen</code> is run.</p>

<h3>
<a name="user-content-including-boxen-modules-from-github-boxenpuppet-" class="anchor" href="#including-boxen-modules-from-github-boxenpuppet-" aria-hidden="true"><span class="octicon octicon-link"></span></a>Including boxen modules from github (boxen/puppet-)</h3>

<p>You must add the github information for your added Puppet module into your Puppetfile at the root of your
boxen repo (ex. /path/to/your-boxen/Puppetfile):</p>

<pre><code># Core modules for a basic development environment. You can replace
# some/most of these if you want, but it's not recommended.

github "repository", "2.0.2"
github "dnsmasq",    "1.0.0"
github "gcc",        "1.0.0"
github "git",        "1.2.2"
github "homebrew",   "1.1.2"
github "hub",        "1.0.0"
github "inifile",    "0.9.0", :repo =&gt; "cprice404/puppetlabs-inifile"
github "nginx",      "1.4.0"
github "nodejs",     "2.2.0"
github "ruby",       "4.1.0"
github "stdlib",     "4.0.2", :repo =&gt; "puppetlabs/puppetlabs-stdlib"
github "sudo",       "1.0.0"

# Optional/custom modules. There are tons available at
# https://github.com/boxen.

github "java",     "1.6.0"
</code></pre>

<p>In the above snippet of a customized Puppetfile, the bottom line
includes the Java module from Github using the tag "1.6.0" from the github repository
"<a href="https://github.com/boxen/puppet-java/releases">boxen/puppet-java/releases</a>".  The function "github" is defined at the top of the Puppetfile
and takes the name of the module, the version, and optional repo location:</p>

<pre><code>def github(name, version, options = nil)
  options ||= {}
  options[:repo] ||= "boxen/puppet-#{name}"
  mod name, version, :github_tarball =&gt; options[:repo]
end
</code></pre>

<p>Now Puppet knows where to download the module from when you include it in your site.pp or mypersonal.pp file:</p>

<pre><code># include the java module referenced in my Puppetfile with the line
# github "java",     "1.6.0"
include java
</code></pre>

<h3>
<a name="user-content-hiera" class="anchor" href="#hiera" aria-hidden="true"><span class="octicon octicon-link"></span></a>Hiera</h3>

<p>Hiera is preferred mechanism to make changes to module defaults (e.g. default
global ruby version, service ports, etc). This repository supplies a
starting point for your Hiera configuration at <code>config/hiera.yml</code>, and an
example data file at <code>hiera/common.yaml</code>. See those files for more details.</p>

<p>The default <code>config/hiera.yml</code> is configured with a hierarchy that allows
individuals to have their own hiera data file in
<code>hiera/users/{github_login}.yaml</code> which augments and overrides
site-wide values in <code>hiera/common.yaml</code>. This default is, as with most of the
configuration in the example repo, a great starting point for many
organisations, but is totally up to you. You might want to, for
example, have a set of values that can't be overridden by adding a file to
the top of the hierarchy, or to have values set on specific OS
versions:</p>

<div class="highlight highlight-yaml"><pre><span class="c1"># ...</span>
<span class="l-Scalar-Plain">:hierarchy</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="s">"global-overrides.yaml"</span>
  <span class="p-Indicator">-</span> <span class="s">"users/%{::github_login}"</span>
  <span class="p-Indicator">-</span> <span class="s">"osx-%{::macosx_productversion_major}"</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">common</span>
</pre></div>

<h3>
<a name="user-content-node-definitions" class="anchor" href="#node-definitions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Node definitions</h3>

<p>Puppet has the concept of a
<a href="http://docs.puppetlabs.com/references/glossary.html#agent">'node'</a>,
which is essentially the machine on which Puppet is running. Puppet looks for
<a href="http://docs.puppetlabs.com/learning/agent_master_basic.html#node-definitions">node definitions</a>
in the <code>manifests/site.pp</code> file in the Boxen repo. You'll see a default node
declaration that looks like the following:</p>

<div class="highlight highlight-puppet"><pre><span class="k">node</span> <span class="k">default</span> <span class="p">{</span><span class="c"></span>
<span class="c">  # core modules, needed for most things</span>
  <span class="k">include</span> <span class="na">dnsmasq</span><span class="c"></span>

<span class="c">  # more...</span>
<span class="p">}</span>
</pre></div>

<h3>
<a name="user-content-how-boxen-interacts-with-puppet" class="anchor" href="#how-boxen-interacts-with-puppet" aria-hidden="true"><span class="octicon octicon-link"></span></a>How Boxen interacts with Puppet</h3>

<p>Boxen runs everything declared in <code>manifests/site.pp</code> by default.
But just like any other source code, throwing all your work into one massive
file is going to be difficult to work with. Instead, we recommend you
use modules in the <code>Puppetfile</code> when you can and make new modules
in the <code>modules/</code> directory when you can't. Then add <code>include $modulename</code>
for each new module in <code>manifests/site.pp</code> to include them.
One pattern that's very common is to create a module for your organization
(e.g., <code>modules/github</code>) and put an environment class in that module
to include all of the modules your organization wants to install for
everyone by default. An example of this might look like so:</p>

<div class="highlight highlight-puppet"><pre><span class="c"># modules/github/manifests/environment.pp</span>

 <span class="k">class</span> <span class="na">github</span><span class="p">::</span><span class="na">environment</span> <span class="p">{</span>
   <span class="k">include</span> <span class="na">github</span><span class="p">::</span><span class="na">apps</span><span class="p">::</span><span class="na">mac</span>

   <span class="k">include</span> <span class="na">ruby</span><span class="p">::</span><span class="mi">1</span><span class="o">-</span><span class="mi">8</span><span class="o">-</span><span class="mi">7</span>

   <span class="k">include</span> <span class="na">projects</span><span class="p">::</span><span class="na">super</span><span class="o">-</span><span class="na">top</span><span class="o">-</span><span class="na">secret</span><span class="o">-</span><span class="na">project</span>
 <span class="p">}</span>
</pre></div>

<p>If you'd like to read more about how Puppet works, we recommend
 checking out <a href="http://docs.puppetlabs.com/">the official documentation</a>
 for:</p>

<ul class="task-list">
<li><a href="http://docs.puppetlabs.com/learning/modules1.html#modules">Modules</a></li>
<li><a href="http://docs.puppetlabs.com/learning/modules1.html#classes">Classes</a></li>
<li><a href="http://docs.puppetlabs.com/learning/definedtypes.html">Defined Types</a></li>
<li><a href="http://docs.puppetlabs.com/guides/custom_facts.html">Facts</a></li>
</ul><h3>
<a name="user-content-creating-a-personal-module" class="anchor" href="#creating-a-personal-module" aria-hidden="true"><span class="octicon octicon-link"></span></a>Creating a personal module</h3>

<p>See <a href="modules/people/README.md">the documentation in the
<code>modules/people</code></a>
directory for creating per-user modules that don't need to be applied
globally to everyone.</p>

<h3>
<a name="user-content-creating-a-project-module" class="anchor" href="#creating-a-project-module" aria-hidden="true"><span class="octicon octicon-link"></span></a>Creating a project module</h3>

<p>See <a href="modules/projects/README.md">the documentation in the
<code>modules/projects</code></a>
directory for creating organization projects (i.e., repositories that people
will be working in).</p>

<h2>
<a name="user-content-binary-packages" class="anchor" href="#binary-packages" aria-hidden="true"><span class="octicon octicon-link"></span></a>Binary packages</h2>

<p>We support binary packaging for everything in Homebrew, rbenv, and nvm.
See <code>config/boxen.rb</code> for the environment variables to define.</p>

<h2>
<a name="user-content-sharing-boxen-modules" class="anchor" href="#sharing-boxen-modules" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sharing Boxen Modules</h2>

<p>If you've got a Boxen module you'd like to be grouped under the Boxen org,
(so it can easily be found by others), please file an issue on this
repository with a link to your module.
We'll review the code briefly, and if things look pretty all right,
we'll fork it under the Boxen org and give you read+write access to our
fork.
You'll still be the maintainer, you'll still own the issues and PRs.
It'll just be listed under the boxen org so folks can find it more easily.</p>

<h2>
<a name="user-content-upgrading-boxen" class="anchor" href="#upgrading-boxen" aria-hidden="true"><span class="octicon octicon-link"></span></a>upgrading boxen</h2>

<p>See <a href="https://github.com/boxen/our-boxen/blob/master/docs/faq.md#q-how-do-you-upgrade-your-boxen-from-the-public-our-boxen">FAQ-Upgrading</a>.</p>

<h2>
<a name="user-content-integrating-with-github-enterprise" class="anchor" href="#integrating-with-github-enterprise" aria-hidden="true"><span class="octicon octicon-link"></span></a>Integrating with Github Enterprise</h2>

<p>If you're using a Github Enterprise instance rather than github.com,
you will need to set the <code>BOXEN_GITHUB_ENTERPRISE_URL</code> and
<code>BOXEN_REPO_URL_TEMPLATE</code> variables in your
<a href="config/boxen.rb">Boxen config</a>.</p>

<h2>
<a name="user-content-halp" class="anchor" href="#halp" aria-hidden="true"><span class="octicon octicon-link"></span></a>Halp!</h2>

<p>See <a href="https://github.com/boxen/our-boxen/blob/master/docs/faq.md">FAQ</a>.</p>

<p>Use Issues or #boxen on irc.freenode.net.</p></article></div>
<div class="announce instapaper_body md" data-path="README.md" id="readme"><article class="markdown-body entry-content" itemprop="mainContentOfPage"><h1>
<a name="user-content-grunt-uncss-" class="anchor" href="#grunt-uncss-" aria-hidden="true"><span class="octicon octicon-link"></span></a>grunt-uncss <a href="http://gruntjs.com/"><img src="https://camo.githubusercontent.com/02d9825a669fb5b9f53bfe2e5a3fa4a1081cdb6a/68747470733a2f2f63646e2e6772756e746a732e636f6d2f6275696c74776974682e706e67" alt="Built with Grunt" data-canonical-src="https://cdn.gruntjs.com/builtwith.png" style="max-width:100%;"></a>
</h1>

<p><a href="http://badge.fury.io/js/grunt-uncss"><img src="https://camo.githubusercontent.com/640de6eb36da7b4aa9a344136b1ce15271a855fb/68747470733a2f2f62616467652e667572792e696f2f6a732f6772756e742d756e6373732e737667" alt="NPM version" data-canonical-src="https://badge.fury.io/js/grunt-uncss.svg" style="max-width:100%;"></a>
<a href="https://travis-ci.org/addyosmani/grunt-uncss"><img src="https://camo.githubusercontent.com/b5cd59494523381c29a536774e2142cf06c488b5/68747470733a2f2f7472617669732d63692e6f72672f616464796f736d616e692f6772756e742d756e6373732e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/addyosmani/grunt-uncss.svg?branch=master" style="max-width:100%;"></a>
<a href="https://david-dm.org/addyosmani/grunt-uncss"><img src="https://camo.githubusercontent.com/ea181a19537c89b3436bc888a64617d13baf13c1/68747470733a2f2f64617669642d646d2e6f72672f616464796f736d616e692f6772756e742d756e6373732e737667" alt="Dependency Status" data-canonical-src="https://david-dm.org/addyosmani/grunt-uncss.svg" style="max-width:100%;"></a>
<a href="https://david-dm.org/addyosmani/grunt-uncss#info=devDependencies"><img src="https://camo.githubusercontent.com/47963fc5052b4253b786943dec4b5bf35ccc7e51/68747470733a2f2f64617669642d646d2e6f72672f616464796f736d616e692f6772756e742d756e6373732f6465762d7374617475732e737667" alt="devDependency Status" data-canonical-src="https://david-dm.org/addyosmani/grunt-uncss/dev-status.svg" style="max-width:100%;"></a></p>

<blockquote>
<p>A grunt task for removing unused CSS from your projects with <a href="https://github.com/giakki/uncss">UnCSS</a>. Works across multiple files and supports dynamically injected CSS via PhantomJS.</p>
</blockquote>

<h2>
<a name="user-content-preview" class="anchor" href="#preview" aria-hidden="true"><span class="octicon octicon-link"></span></a>Preview</h2>

<p>Taking a multi-page project using Bootstrap with &gt;120KB of CSS down to 11KB.</p>

<p><a href="https://camo.githubusercontent.com/986f80f311f534223b46dfd3addcf1e7257698eb/687474703a2f2f692e696d6775722e636f6d2f7568574d414c482e676966" target="_blank"><img src="https://camo.githubusercontent.com/986f80f311f534223b46dfd3addcf1e7257698eb/687474703a2f2f692e696d6775722e636f6d2f7568574d414c482e676966" alt="Demo" data-canonical-src="http://i.imgur.com/uhWMALH.gif" style="max-width:100%;"></a></p>

<h2>
<a name="user-content-getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span class="octicon octicon-link"></span></a>Getting Started</h2>

<p>This plugin requires Grunt <code>~0.4.0</code></p>

<p>If you haven't used <a href="http://gruntjs.com/">Grunt</a> before, be sure to check out the
<a href="http://gruntjs.com/getting-started">Getting Started</a> guide, as it explains how to create
a <a href="http://gruntjs.com/sample-gruntfile">Gruntfile</a> as well as install and use Grunt plugins.
Once you're familiar with that process, you may install this plugin with this command:</p>

<pre lang="shell"><code>npm install grunt-uncss --save-dev
</code></pre>

<p>Once the plugin has been installed, it may be enabled inside your Gruntfile with this line of JavaScript:</p>

<div class="highlight highlight-js"><pre><span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span><span class="s1">'grunt-uncss'</span><span class="p">);</span>
</pre></div>

<h2>
<a name="user-content-uncss-task" class="anchor" href="#uncss-task" aria-hidden="true"><span class="octicon octicon-link"></span></a>Uncss task</h2>

<p><em>Run this task with the <code>grunt uncss</code> command.</em></p>

<p>Task targets, files and options may be specified according to the grunt <a href="http://gruntjs.com/configuring-tasks">Configuring tasks</a> guide.</p>

<h3>
<a name="user-content-usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h3>

<p>Use the <code>grunt-uncss</code> task by specifying a target destination (file) for your cleaned CSS.
Below this is <code>dist/css/tidy.css</code>.</p>

<p>Along-side, specify the input HTML files you would like scanned for used selectors.
In this case <code>app/index.html</code> and <code>app/about.html</code> are the two files we would like checked.</p>

<div class="highlight highlight-js"><pre><span class="nx">uncss</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">dist</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">files</span><span class="o">:</span> <span class="p">{</span>
      <span class="s1">'dist/css/tidy.css'</span><span class="o">:</span> <span class="p">[</span><span class="s1">'app/index.html'</span><span class="p">,</span> <span class="s1">'app/about.html'</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>Which you can then use alongside a processor like <code>processhtml</code> to
rewrite the location of your stylesheet to <code>tidy.css</code> using a block
like:</p>

<div class="highlight highlight-html"><pre><span class="c">&lt;!-- build:css css/tidy.css --&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"css/normalize.css"</span><span class="nt">&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"css/main.css"</span><span class="nt">&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"css/bootstrap.css"</span><span class="nt">&gt;</span>
<span class="c">&lt;!-- /build --&gt;</span>
</pre></div>

<p>and some configuration like:</p>

<div class="highlight highlight-js"><pre><span class="nx">processhtml</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">dist</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">files</span><span class="o">:</span> <span class="p">{</span>
      <span class="s1">'dist/index.html'</span><span class="o">:</span> <span class="p">[</span><span class="s1">'app/index.html'</span><span class="p">],</span>
      <span class="s1">'dist/about.html'</span><span class="o">:</span> <span class="p">[</span><span class="s1">'app/about.html'</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h2>
<a name="user-content-options" class="anchor" href="#options" aria-hidden="true"><span class="octicon octicon-link"></span></a>Options</h2>

<p>Sample use of all supported options:</p>

<div class="highlight highlight-js"><pre><span class="nx">uncss</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">dist</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">ignore</span>       <span class="o">:</span> <span class="p">[</span><span class="s1">'#added_at_runtime'</span><span class="p">,</span> <span class="sr">/test\-[0-9]+/</span><span class="p">],</span>
      <span class="nx">media</span>        <span class="o">:</span> <span class="p">[</span><span class="s1">'(min-width: 700px) handheld and (orientation: landscape)'</span><span class="p">],</span>
      <span class="nx">csspath</span>      <span class="o">:</span> <span class="s1">'../public/css/'</span><span class="p">,</span>
      <span class="nx">raw</span>          <span class="o">:</span> <span class="s1">'h1 { color: green }'</span><span class="p">,</span>
      <span class="nx">stylesheets</span>  <span class="o">:</span> <span class="p">[</span><span class="s1">'lib/bootstrap/dist/css/bootstrap.css'</span><span class="p">,</span> <span class="s1">'src/public/css/main.css'</span><span class="p">],</span>
      <span class="nx">ignoreSheets</span> <span class="o">:</span> <span class="p">[</span><span class="sr">/fonts.googleapis/</span><span class="p">],</span>
      <span class="nx">urls</span>         <span class="o">:</span> <span class="p">[</span><span class="s1">'http://localhost:3000/mypage'</span><span class="p">,</span> <span class="s1">'...'</span><span class="p">],</span> <span class="c1">// Deprecated</span>
      <span class="nx">timeout</span>      <span class="o">:</span> <span class="mi">1000</span><span class="p">,</span>
      <span class="nx">htmlroot</span>     <span class="o">:</span> <span class="s1">'public'</span><span class="p">,</span>
      <span class="nx">report</span>       <span class="o">:</span> <span class="s1">'min'</span>
    <span class="p">},</span>
    <span class="nx">files</span><span class="o">:</span> <span class="p">{</span>
      <span class="s1">'dist/css/tidy.css'</span><span class="o">:</span> <span class="p">[</span><span class="s1">'app/index.html'</span><span class="p">,</span> <span class="s1">'app/about.html'</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h3>
<a name="user-content-what-do-the-options-do" class="anchor" href="#what-do-the-options-do" aria-hidden="true"><span class="octicon octicon-link"></span></a>What do the options do?</h3>

<ul class="task-list">
<li><p><strong>ignore</strong> (Array): provide a list of selectors that should not be removed by UnCSS. For example, styles added by user interaction with the page (<code>hover</code>, <code>click</code>), since those are not detectable by UnCSS yet. Both literal names and regex patterns are recognized.</p></li>
<li><p><strong>media</strong> (Array): by default UnCSS processes only stylesheets with media query "<em>all</em>", "<em>screen</em>", and those without one. Specify here which others to include.</p></li>
<li><p><strong>csspath</strong> (String): path where the CSS files are related to the html files. By default, UnCSS uses the path specified in the <code>&lt;link rel="stylesheet" href="path/to/file.css"&gt;</code>.</p></li>
<li><p><strong>raw</strong> (String): give the task a raw string of CSS in addition to the existing stylesheet options; useful in scripting when your CSS hasn't yet been written to disk.</p></li>
<li><p><strong>stylesheets</strong> (Array): use these stylesheets instead of those extracted from the html files.</p></li>
<li><p><strong>ignoreSheets</strong> (Array):  Do not include the specified stylesheets.</p></li>
<li><p><strong>urls</strong> (Array): array of URLs to load with Phantom (on top of the files already passed if any).</p></li>
<li><p><strong>timeout</strong> (Number): specify how long to wait for the JS to be loaded.</p></li>
<li><p><strong>htmlroot</strong> (String): where the project root is. Useful for example if you are running UnCSS on <em>local</em> files that have absolute href to the stylesheets, i.e. <code>href="/css/style.css"</code>.</p></li>
<li><p><strong>report</strong> ('min'/'gzip'): specify whether to print out only the minification result or report minification and gzip results, using <a href="https://github.com/sindresorhus/maxmin">maxmin</a>.</p></li>
</ul><h3>
<a name="user-content-usage-examples" class="anchor" href="#usage-examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage examples</h3>

<div class="highlight highlight-js"><pre><span class="c1">// Remove unused CSS across multiple files</span>
<span class="nx">uncss</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">dist</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">files</span><span class="o">:</span> <span class="p">{</span>
      <span class="s1">'dist/css/tidy.css'</span><span class="o">:</span> <span class="p">[</span><span class="s1">'app/index.html'</span><span class="p">,</span> <span class="s1">'app/about.html'</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<div class="highlight highlight-js"><pre><span class="c1">// Remove unused CSS across multiple files and ignore specific selectors</span>
<span class="nx">uncss</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">dist</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">ignore</span><span class="o">:</span> <span class="p">[</span><span class="s1">'#added_at_runtime'</span><span class="p">,</span> <span class="s1">'.created_by_jQuery'</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="nx">files</span><span class="o">:</span> <span class="p">{</span>
      <span class="s1">'dist/css/tidy.css'</span><span class="o">:</span> <span class="p">[</span><span class="s1">'app/index.html'</span><span class="p">,</span> <span class="s1">'app/about.html'</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h3>
<a name="user-content-test-project" class="anchor" href="#test-project" aria-hidden="true"><span class="octicon octicon-link"></span></a>Test project</h3>

<p>There is a test project included under the <code>tests/app</code> directory which you can build by running <code>grunt</code> after an <code>npm install</code>.
It also includes a <code>grunt compare_size</code> task for getting a feel of the before and after CSS sizes:</p>

<p><a href="https://camo.githubusercontent.com/bf1db66cf692214bd33d21720adb0b426be5498a/687474703a2f2f692e696d6775722e636f6d2f625573654350682e706e67" target="_blank"><img src="https://camo.githubusercontent.com/bf1db66cf692214bd33d21720adb0b426be5498a/687474703a2f2f692e696d6775722e636f6d2f625573654350682e706e67" alt="grunt compare_size" data-canonical-src="http://i.imgur.com/bUseCPh.png" style="max-width:100%;"></a></p>

<h2>
<a name="user-content-examples" class="anchor" href="#examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h2>

<h3>
<a name="user-content-sites" class="anchor" href="#sites" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sites</h3>

<ul class="task-list">
<li><a href="https://github.com/h5bp/html5boilerplate.com">HTML5Boilerplate.com website</a></li>
<li><a href="https://github.com/mozilla/dxr">Mozilla's DXR documentation viewer</a></li>
<li><a href="https://github.com/vanilla/vanilladocs">Vanilla forums docs site</a></li>
</ul><h3>
<a name="user-content-apps" class="anchor" href="#apps" aria-hidden="true"><span class="octicon octicon-link"></span></a>Apps</h3>

<ul class="task-list">
<li><a href="https://github.com/vinitkumar/github-team-viewer">GitHub Team Viewer - Angular app</a></li>
<li><a href="https://github.com/JeremyCarlsten/grunt-uncss-angular-example">Angular Todo application</a></li>
<li><a href="https://github.com/carlo-colombo/CashSplitter">CashSplitter - Angular app with PouchDB, Bootstrap</a></li>
<li><a href="https://github.com/WillsonSmith/thisWeeksComics">This Week's Comics Express app</a></li>
<li><a href="https://github.com/addyosmani/grunt-uncss-sass-example">Sample grunt-uncss in a Sass project</a></li>
</ul><h3>
<a name="user-content-other" class="anchor" href="#other" aria-hidden="true"><span class="octicon octicon-link"></span></a>Other</h3>

<ul class="task-list">
<li><a href="https://github.com/sboodhoo/Grunt-UnCSS-WordPress">Using grunt-uncss with Wordpress</a></li>
<li><a href="https://github.com/phoenixMag00/JSON-Sitemap-Generator-for-Grunt-UnCSS-with-WordPress">JSON Sitemap generator for grunt-uncss</a></li>
</ul><h2>
<a name="user-content-the-problem" class="anchor" href="#the-problem" aria-hidden="true"><span class="octicon octicon-link"></span></a>The problem</h2>

<p>User-interface libraries like <a href="http://getbootstrap.com">Bootstrap</a>, <a href="http://topcoat.io">TopCoat</a>
and so on are fairly prolific, however many developers use less than 10% of the CSS they provide
(when opting for the full build, which most do). As a result, they can end up with fairly bloated
stylesheets which can significantly increase page load time and affect performance.
<code>grunt-uncss</code> is an attempt to help with by generating a CSS file containing only the CSS used
in your project, based on selector testing.</p>

<h2>
<a name="user-content-research-and-alternative-solutions" class="anchor" href="#research-and-alternative-solutions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Research and alternative solutions</h2>

<p>There have been many efforts to try solving the problem of finding unused CSS in the past. Opera created
<a href="https://github.com/operasoftware/ucss">ucss</a>, @aanand created (<a href="https://github.com/aanand/deadweight">https://github.com/aanand/deadweight</a>),
Brian Le Roux <a href="https://github.com/brianleroux/css-slap-chop">CSS Slap Chop</a> and there were a number of
client-side solutions also crafted, such as <a href="https://github.com/geuis/helium-css">Helium-CSS</a>,
<a href="https://github.com/driverdan/cssess">CSSESS</a> and the Python <a href="http://www.peterbe.com/plog/mincss">mincss</a>.</p>

<p>Unfortunately, most of these solutions don't actually generate what you're really after - a leaner build
of your project CSS containing only those rules you used. Finding that a more recent project called
<a href="https://github.com/giakki/uncss">UnCSS</a> did try tackling this, I set out to share some of the problems we
need to solve in this space with the developer and build a Grunt task to enable usage of it in builds more
easily.</p>

<p>Huge thanks go out to Giacomo Martino for his help with the Node module this task uses.</p>

<h2>
<a name="user-content-coverage" class="anchor" href="#coverage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Coverage</h2>

<ul class="task-list">
<li><a href="http://addyosmani.com/blog/removing-unused-css/">Spring-cleaning unused CSS with Grunt, Gulp &amp; other build systems</a></li>
<li><a href="http://www.youtube.com/watch?v=833xr1MyE30">Automating the removal of unused CSS - VelocityConf</a></li>
<li><a href="http://xdamman.com/website-optimization-grunt-uncss">Use Grunt and UnCSS to speed up the load time of your site</a></li>
<li><a href="http://corydowdy.com/blog/foundation-5-sass-and-grunt-uncss">Foundation 5, Sass and Grunt UnCSS</a></li>
<li><a href="https://speakerdeck.com/addyosmani/automating-front-end-workflow">Automating Front-end Workflow (slides)</a></li>
<li><a href="http://deanhume.com/Home/BlogPost/automatically-removing-unused-css-using-grunt/6101">Automatically removing unused CSS - Windows</a></li>
<li><a href="https://medium.com/p/32d607879082">Workflow for responsive email with Grunt and UnCSS</a></li>
</ul><h2>
<a name="user-content-wordpress" class="anchor" href="#wordpress" aria-hidden="true"><span class="octicon octicon-link"></span></a>WordPress</h2>

<p>While UnCSS works best (and quickest) with static html files, it is possible to pass in
a URL array that contains all the URLs on your website, and process all used selectors that way.
<a href="https://github.com/lgladdy">@lgladdy</a> wrote a guide on how to do this
<a href="http://www.gladdy.co.uk/blog/2014/04/13/using-uncss-and-grunt-uncss-with-wordpress/">on his blog</a></p>

<h2>
<a name="user-content-notes" class="anchor" href="#notes" aria-hidden="true"><span class="octicon octicon-link"></span></a>Notes</h2>

<p>At present we have decided to lock grunt-uncss into <a href="https://github.com/giakki/uncss/">UnCSS 0.8.1</a>. This is the most recent version we consider stable for production use. We will be reviewing future UnCSS releases and deciding to upgrade when we feel sufficient stability is back.</p>

<h2>
<a name="user-content-limitations" class="anchor" href="#limitations" aria-hidden="true"><span class="octicon octicon-link"></span></a>Limitations</h2>

<p>Please note that the CSS parser used in the <code>uncss</code> module we rely on currently isn't able to work with complex selectors.
For example <code>[data-section=''] &gt; section &gt; [data-section-title] a</code>. This may mean that at build time you run into exceptions
such as <code>TypeError: Cannot convert undefined or null to object</code>. If this is the case, please consider moving these selectors
to a separate stylesheet which the task does not run on.</p>

<p>We are actively looking at how to improve the CSS parsers used and will update this notice once this problem has been solved.</p>

<h2>
<a name="user-content-license" class="anchor" href="#license" aria-hidden="true"><span class="octicon octicon-link"></span></a>License</h2>

<p>(C) Addy Osmani 2014, released under the MIT license</p></article></div>
<div class="announce instapaper_body md" data-path="README.md" id="readme"><article class="markdown-body entry-content" itemprop="mainContentOfPage"><p><a href="https://camo.githubusercontent.com/7693c3a15b2962afd24546cd2a8c7ff299006412/68747470733a2f2f7261772e6769746875622e636f6d2f67696269616e736b792f494861736b656c6c2f6d61737465722f696d616765732f696861736b656c6c2d6c6f676f2e706e67" target="_blank"><img src="https://camo.githubusercontent.com/7693c3a15b2962afd24546cd2a8c7ff299006412/68747470733a2f2f7261772e6769746875622e636f6d2f67696269616e736b792f494861736b656c6c2f6d61737465722f696d616765732f696861736b656c6c2d6c6f676f2e706e67" alt="IHaskell" data-canonical-src="https://raw.github.com/gibiansky/IHaskell/master/images/ihaskell-logo.png" style="max-width:100%;"></a></p>

<h1>
<a name="user-content-ihaskell" class="anchor" href="#ihaskell" aria-hidden="true"><span class="octicon octicon-link"></span></a>IHaskell</h1>

<p>IHaskell is an implementation of the <a href="http://ipython.org">IPython</a> kernel protocol which allows you to use Haskell inside IPython frontends such as <code>qtconsole</code> and <code>notebook</code>.</p>

<p><a href="http://gibiansky.github.io/IHaskell/demo.html">Demo Notebook</a></p>

<p><strong><em>Please</em> run <code>cabal update</code> before installing - IHaskell updates <em>very</em> regularly!</strong></p>

<hr><p>The project works with the IPython shell:</p>

<p><a href="https://camo.githubusercontent.com/0696d1ef7ed583582b35536bdeccdb149e817b49/68747470733a2f2f7261772e6769746875622e636f6d2f67696269616e736b792f494861736b656c6c2f6d61737465722f696d616765732f696861736b656c6c2d636f6e736f6c652e706e67" target="_blank"><img src="https://camo.githubusercontent.com/0696d1ef7ed583582b35536bdeccdb149e817b49/68747470733a2f2f7261772e6769746875622e636f6d2f67696269616e736b792f494861736b656c6c2f6d61737465722f696d616765732f696861736b656c6c2d636f6e736f6c652e706e67" alt="IPython Console" data-canonical-src="https://raw.github.com/gibiansky/IHaskell/master/images/ihaskell-console.png" style="max-width:100%;"></a></p>

<p>As well as the IPython browser-based notebook interface:</p>

<p><a href="https://camo.githubusercontent.com/8e92d2d571f80b17019e8e477cc29015cf57a4bd/68747470733a2f2f7261772e6769746875622e636f6d2f67696269616e736b792f494861736b656c6c2f6d61737465722f696d616765732f696861736b656c6c2d6e6f7465626f6f6b2e706e67" target="_blank"><img src="https://camo.githubusercontent.com/8e92d2d571f80b17019e8e477cc29015cf57a4bd/68747470733a2f2f7261772e6769746875622e636f6d2f67696269616e736b792f494861736b656c6c2f6d61737465722f696d616765732f696861736b656c6c2d6e6f7465626f6f6b2e706e67" alt="IPython Notebook" data-canonical-src="https://raw.github.com/gibiansky/IHaskell/master/images/ihaskell-notebook.png" style="max-width:100%;"></a></p>

<h1>
<a name="user-content-more-usage-information-on-the-wiki" class="anchor" href="#more-usage-information-on-the-wiki" aria-hidden="true"><span class="octicon octicon-link"></span></a>More usage information on the <a href="https://github.com/gibiansky/IHaskell/wiki">wiki</a>.</h1>

<h1>
<a name="user-content-linux-package-installation" class="anchor" href="#linux-package-installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Linux Package Installation</h1>

<p>There is a Docker package for Linux.</p>

<pre><code>sudo docker run -p 8778:8778 gregweber/ihaskell
</code></pre>

<p>This is defaulted to run the browser. You can run the console instead with</p>

<pre><code>sudo docker run -rm -i -t gregweber/ihaskell console
</code></pre>

<h1>
<a name="user-content-windows-installation" class="anchor" href="#windows-installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Windows Installation</h1>

<p>Install Virtualbox. Load a Linux distro and install Docker, then run the Docker package.
This also works on Mac, but Mac users may prefer installing from source.</p>

<h1>
<a name="user-content-source-installation-mac-and-linux" class="anchor" href="#source-installation-mac-and-linux" aria-hidden="true"><span class="octicon octicon-link"></span></a>Source Installation (Mac and Linux)</h1>

<p>If you have any trouble with installation or have other questions about IHaskell, feel free to open an issue <a href="https://github.com/gibiansky/IHaskell/issues?direction=desc&amp;sort=updated&amp;state=open">on Github</a> or join our IRC at #ihaskell on chat.freenode.net.</p>

<p>IHaskell is built on top of IPython, which provides the frontends and the entire infrastructure. By default, IHaskell will attempt to use the system IPython installation. If it fails to find one, it will create its own virtualenv and install all its own Python dependencies (this happens on the first run). However, if you want to provide your own IPython to override the automatic behaviour, you can instead pass IHaskell the <code>--ipython /path/to/exec/ipython</code> flag, in which case the installation will not happen and it'll just use the IPython you passed it. You <em>must</em> have IPython 2.0, though; older versions will <em>not</em> work properly!  Installing IPython 2.0 from PyPI is recommended (as this is how the automatic installer does it).</p>

<p><em>Note that since the default install  uses virtualenv, your system must be virtualenv compatibile. Mac users have run into <a href="http://stackoverflow.com/questions/5904319/problem-with-virtualenv-in-mac-os-x">this issue</a> before, for example.</em></p>

<h2>
<a name="user-content-zeromq" class="anchor" href="#zeromq" aria-hidden="true"><span class="octicon octicon-link"></span></a>ZeroMQ</h2>

<p>IHaskell uses a library known as ZeroMQ for asynchronous communication. Make sure that ZeroMQ 4 is installed - it is a relatively recent library and thus you may have older versions installed.</p>

<p>For Macs, you can easily install it with <a href="http://brew.sh/">Homebrew</a>:</p>

<div class="highlight highlight-bash"><pre><span class="c"># For Macs with Homebrew:</span>
brew update
brew install zeromq
</pre></div>

<p>(If using 32-bit Haskell Platform, you <em>may</em> need to use <code>brew install zeromq --universal</code>. YMMV.)</p>

<p>On other platforms, you can easily install from source:</p>

<div class="highlight highlight-bash"><pre><span class="c"># Compiling from source:</span>
git clone git@github.com:zeromq/zeromq4-x.git libzmq
<span class="nb">cd </span>libzmq
./autogen.sh <span class="o">&amp;&amp;</span> ./configure <span class="o">&amp;&amp;</span> make
sudo make install
sudo ldconfig
</pre></div>

<p>If your own platform has a package and I haven't included instructions for it, feel free to send me an email or a PR on this README.</p>

<h2>
<a name="user-content-haskell-and-cabal" class="anchor" href="#haskell-and-cabal" aria-hidden="true"><span class="octicon octicon-link"></span></a>Haskell and Cabal</h2>

<p>You should also have GHC and modern Cabal:</p>

<div class="highlight highlight-bash"><pre>ghc --numeric-version <span class="c"># Should be 7.6.3, 7.8.2, or 7.8.3</span>
cabal --version       <span class="c"># Should be 1.18.* or newer</span>
</pre></div>

<p>Since IHaskell uses the GHC API for evaluation and parsing, other versions of GHC may not work.</p>

<p>If you do not have GHC or Cabal, you should be able to install both via the 
<a href="http://www.haskell.org/platform/">Haskell Platform</a>. On Macs with Homebrew, you can do this via</p>

<div class="highlight highlight-bash"><pre><span class="c"># Macs with Homebrew only, if you don't have GHC or Cabal</span>
brew install haskell-platform
cabal update <span class="o">&amp;&amp;</span> cabal install cabal-install
</pre></div>

<p>Use <code>cabal install cabal-install</code> to update Cabal if you still have version 1.16 instead of 1.18.</p>

<p>Also, in order to use executables which <code>cabal</code> installs, they must be in your path. Execute this in your shell or add it to your <code>~/.bashrc</code>:</p>

<div class="highlight highlight-bash"><pre><span class="c"># If you have a ~/.cabal/bin folder:</span>
<span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>~/.cabal/bin:<span class="nv">$PATH</span>

<span class="c"># If you have a ~/Library/Haskell/bin folder on OS X:</span>
<span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>~/Library/Haskell/bin:<span class="nv">$PATH</span>
</pre></div>

<p>Some of the IHaskell packages depend on <code>cairo</code>, such as <code>ihaskell-diagrams</code>, where <code>cairo</code> is used for drawing the displays. If you are using Mac OS X 10.9 (Mavericks) you will need to compile
cairo with gcc, not clang. This can be done as follows:</p>

<div class="highlight highlight-bash"><pre>brew install gcc48
cabal install cairo --with-gcc<span class="o">=</span>gcc-4.8
</pre></div>

<p>Note that this is only necessary if you want to use the <code>ihaskell-display</code> packages provided.</p>

<h2>
<a name="user-content-compilation-tools" class="anchor" href="#compilation-tools" aria-hidden="true"><span class="octicon octicon-link"></span></a>Compilation Tools</h2>

<p>Install the <code>happy</code> parser generator tool and <code>cpphs</code> preprocessor:</p>

<div class="highlight highlight-bash"><pre>cabal install happy cpphs
</pre></div>

<h2>
<a name="user-content-python-installation" class="anchor" href="#python-installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Python Installation</h2>

<p>IHaskell will automatically install python tools itself.
If you already have ipython installed you can use the --ipython flag.</p>

<p>On Linux make sure you also have <code>python-dev</code> (or equivalent) installed, which is needed to install <code>pyzmq</code></p>

<h2>
<a name="user-content-ihaskell-installation" class="anchor" href="#ihaskell-installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>IHaskell Installation</h2>

<p>Install the IHaskell package from Hackage:</p>

<div class="highlight highlight-bash"><pre>cabal update <span class="c"># Please do this! IHaskell updates *very* frequently.</span>
cabal install ihaskell --reorder-goals
</pre></div>

<p>The <code>--reorder-goals</code> flag is necessary due to a bug in <code>cabal-install</code>. The <code>--solver=topdown</code> also seems to do the trick.</p>

<p>If you have trouble with this installation, please make sure to try the Github version first. IHaskell is in rapid development, so Hackage may not always be the most recent. In order to install from Github, pull from the repository, and then install with</p>

<div class="highlight highlight-bash"><pre>./build.sh all
</pre></div>

<p>Note that you should <em>not</em> use <code>cabal install</code>, as you want to also install dependencies from the Github source, and not Hackage. <code>build.sh</code> is a simple included script which manages this for you.</p>

<h2>
<a name="user-content-running-ihaskell" class="anchor" href="#running-ihaskell" aria-hidden="true"><span class="octicon octicon-link"></span></a>Running IHaskell</h2>

<p>Finally, run the notebook or console interface:</p>

<div class="highlight highlight-bash"><pre>IHaskell notebook <span class="c"># Should open a browser window!</span>
IHaskell console
</pre></div>

<h4>
<a name="user-content-gotchas" class="anchor" href="#gotchas" aria-hidden="true"><span class="octicon octicon-link"></span></a>Gotchas</h4>

<p>These are simply some problems have had and solutions to them.</p>

<p><strong>Problem</strong>: You have Anaconda or Enthought or some other python distribution, and for unknown reasons IHaskell just hangs after the first input.</p>

<p><strong>Solution</strong>: Anaconda and Enthought cause problems. Get rid of them.</p>

<p><strong>Problem</strong>: You get an error when <code>pyzmq</code> is compiling that looks somewhat like</p>

<pre><code>cc1: error: -Werror=unused-command-line-argument-hard-error-in-future: No option -Wunused-command-line-argument-hard-error-in-future
</code></pre>

<p><strong>Solution:</strong> Rerun the command after changing the <code>ARCHFLAGS</code> variable via</p>

<div class="highlight highlight-bash"><pre><span class="nb">export </span><span class="nv">ARCHFLAGS</span><span class="o">=</span>-Wno-error<span class="o">=</span>unused-command-line-argument-hard-error-in-future
</pre></div>

<p>If you want to pass specific options to the underlying IPython, you can do it like this:</p>

<div class="highlight highlight-bash"><pre><span class="c"># Expose the notebook on all ports!</span>
<span class="nv">IHASKELL_IPYTHON_ARGS</span><span class="o">=</span><span class="s2">"--ip=*"</span> ihaskell notebook
</pre></div>

<p>Anything in <code>IHASKELL_IPYTHON_ARGS</code> will be passed to the underlying <code>ipython</code> instance as an argument when you run IHaskell.</p>

<p>There is a test notebook in the <code>IHaskell</code> directory. To try it, run IHaskell with <code>IHaskell notebook --serve=IHaskell</code>.</p>

<p>If you get a pip error while IHaskell is installing Python
dependencies on the first run (it will look like
<code>EOFError: EOF when reading a line</code>), then you can do the following
after ensuring that pip &gt;= 1.5 is installed:</p>

<div class="highlight highlight-bash"><pre>env <span class="nv">PIP_EXISTS_ACTION</span><span class="o">=</span>w IHaskell notebook
</pre></div>

<p>If it <em>still</em> doesn't work and you are using Mac OS X then
<code>brew upgrade python</code>. Some older versions of Homebrew's Python have a
broken version of distutils. Homebrew's version of Python 2.7.6 <em>does</em> work.</p>

<p><strong>Note</strong>: You may have some trouble due to browser caches with the notebook interface if you also use IPython's notebook interface or have used it in the past. If something doesn't work or IPython says it can't connect to the notebook server, make sure to clear the browser cache in whatever browser you're using, or try another browser.</p>

<h1>
<a name="user-content-contributing" class="anchor" href="#contributing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contributing</h1>

<p>IHaskell is a young project, and I'd love your help getting it to a stable and useful point. There's a lot to do, and if you'd like to contribute, feel free to get in touch with me via my email at andrew period gibiansky at gmail - although browsing the code should be enough to get you started, I'm more than happy to answer any questions myself.</p>

<p><strong>For package maintainers:</strong> IHaskell has an ability to display data types it knows about with a rich format based on images or HTML. In order to do so, an external package <code>ihaskell-something</code> must be created and installed. Writing these packages is simply - they must just contain instance of the <code>IHaskellDisplay</code> typeclass, defined in <code>IHaskell.Display</code>, and for a package <code>ihaskell-something</code> should have a single module <code>IHaskell.Display.Something</code>. If you have a package with interesting data types that would benefit from a rich display format, please get in contact with me (andrew dot gibiansky at gmail) to write one of these packages! A sample package is available <a href="https://github.com/gibiansky/IHaskell/tree/master/ihaskell-display/ihaskell-basic">here</a>.</p>

<h2>
<a name="user-content-developer-notes" class="anchor" href="#developer-notes" aria-hidden="true"><span class="octicon octicon-link"></span></a>Developer Notes</h2>

<p>Before diving in, you should read the <a href="http://andrew.gibiansky.com/blog/ipython/ipython-kernels/">brief description of IPython kernel architectures</a>
and read the <a href="http://ipython.org/ipython-doc/dev/development/messaging.html">complete messaging protocol specification</a>.</p>

<p>Skim the rather-lacking <a href="http://gibiansky.github.io/IHaskell/IHaskell/">Haddock documentation</a>.</p>

<p>First steps:</p>

<ul class="task-list">
<li>Fork the repository on Github and clone your fork for editing. </li>
</ul><p><strong>option 1</strong> </p>

<div class="highlight highlight-bash"><pre><span class="nb">cd</span> /path/to/IHaskell
./build.sh
</pre></div>

<p><strong>option 2</strong></p>

<div class="highlight highlight-bash"><pre><span class="nb">cd</span> /path/to/IHaskell
cabal sandbox init
cabal sandbox add-source ihaskell-display/* ghc-parser
cabal install IHaskell <span class="k">$(</span>basename ihaskell-display/*<span class="k">)</span>
</pre></div>

<p><strong>Loading IHaskell into GHCi for testing:</strong></p>

<p>Use one of the methods below to access IHaskell files in GHCi. Once inside GHCi, you can load an IHaskell file; for example, <code>:load IHaskell/Config.hs</code>.</p>

<p><strong>Using cabal repl</strong></p>

<p>If you have the latest version of cabal (&gt;v1.18.0), the simplest thing to do is </p>

<div class="highlight highlight-bash"><pre><span class="nb">cd</span> &lt;path-to-IHaskell&gt;
cabal repl
</pre></div>

<p>This will hide all packages not listed in <code>IHaskell.cabal</code></p>

<p><strong>Using GHCi directly</strong></p>

<p>If you don't want to use <code>cabal repl</code>, you can just call ghci which can read the <code>.ghci</code> file included in the repository for the options.</p>

<div class="highlight highlight-bash"><pre><span class="nb">cd</span> &lt;path-to-IHaskell&gt;
chmod <span class="m">600</span> .ghci <span class="c"># trust the .ghci file</span>
ghci
</pre></div>

<p>Then in the ghci session  you can type things like:</p>

<pre><code>:set -package setenv
:load src/Hspec.hs
hspec parserTests
:browse IHaskell.Types
</code></pre></article></div>
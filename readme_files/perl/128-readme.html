<div class="announce instapaper_body md" data-path="README.md" id="readme"><article class="markdown-body entry-content" itemprop="mainContentOfPage"><p><a href="https://travis-ci.org/tokuhirom/Amon"><img src="https://camo.githubusercontent.com/d3e39ce01e105450b92a0d3c22db6bdb55ce2bf1/68747470733a2f2f7472617669732d63692e6f72672f746f6b756869726f6d2f416d6f6e2e706e673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/tokuhirom/Amon.png?branch=master" style="max-width:100%;"></a></p>

<h1>
<a name="user-content-name" class="anchor" href="#name" aria-hidden="true"><span class="octicon octicon-link"></span></a>NAME</h1>

<p>Amon2 - lightweight web application framework</p>

<h1>
<a name="user-content-synopsis" class="anchor" href="#synopsis" aria-hidden="true"><span class="octicon octicon-link"></span></a>SYNOPSIS</h1>

<pre><code>package MyApp;
use parent qw/Amon2/;
use Amon2::Config::Simple;
sub load_config { Amon2::Config::Simple-&gt;load(shift) }
</code></pre>

<h1>
<a name="user-content-description" class="anchor" href="#description" aria-hidden="true"><span class="octicon octicon-link"></span></a>DESCRIPTION</h1>

<p>Amon2 is simple, readable, extensible, <strong>STABLE</strong>, <strong>FAST</strong> web application framework based on <a href="https://metacpan.org/pod/Plack">Plack</a>.</p>

<h1>
<a name="user-content-methods" class="anchor" href="#methods" aria-hidden="true"><span class="octicon octicon-link"></span></a>METHODS</h1>

<h2>
<a name="user-content-class-methods-for-amon2-class" class="anchor" href="#class-methods-for-amon2-class" aria-hidden="true"><span class="octicon octicon-link"></span></a>CLASS METHODS for <code>Amon2</code> class</h2>

<ul class="task-list">
<li>
<p>my $c = MyApp-&gt;context();</p>

<p>Get the context object.</p>
</li>
<li>
<p>MyApp-&gt;set_context($c)</p>

<p>Set your context object(INTERNAL USE ONLY).</p>
</li>
</ul><h1>
<a name="user-content-class-methods-for-inherited-class" class="anchor" href="#class-methods-for-inherited-class" aria-hidden="true"><span class="octicon octicon-link"></span></a>CLASS METHODS for inherited class</h1>

<ul class="task-list">
<li>
<p><code>MyApp-&gt;config()</code></p>

<p>This method returns configuration information. It is generated by <code>MyApp-&gt;load_config()</code>.</p>
</li>
<li>
<p><code>MyApp-&gt;mode_name()</code></p>

<p>This is a mode name for Amon2. The default implementation of this method is:</p>

<pre><code>sub mode_name { $ENV{PLACK_ENV} }
</code></pre>

<p>You can override this method if you want to determine the mode by other method.</p>
</li>
<li>
<p><code>MyApp-&gt;new()</code></p>

<p>Create new context object.</p>
</li>
<li>
<p><code>MyApp-&gt;bootstrap()</code></p>

<pre><code>my $c = MyApp-&gt;bootstrap();
</code></pre>

<p>Create new context object and set it to global context. When you are writing CLI script, setup the global context object by this method.</p>
</li>
<li>
<p><code>MyApp-&gt;base_dir()</code></p>

<p>This method returns the application base directory.</p>
</li>
<li>
<p><code>MyApp-&gt;load_plugin($module_name[, \%config])</code></p>

<p>This method loads the plugin for the application.</p>

<p><em>$module_name</em> package name of the plugin. You can write it as two form like <a href="https://metacpan.org/pod/DBIx::Class">DBIx::Class</a>:</p>

<pre><code>__PACKAGE__-&gt;load_plugin("Web::CSRFDefender");    # =&gt; loads Amon2::Plugin::Web::CSRFDefender
</code></pre>

<p>If you want to load a plugin in your own name space, use the '+' character before a package name, like following:
    __PACKAGE__-&gt;load_plugin("+MyApp::Plugin::Foo"); # =&gt; loads MyApp::Plugin::Foo</p>
</li>
<li>
<p><code>MyApp-&gt;load_plugins($module_name[, \%config ], ...)</code></p>

<p>Load multiple plugins at one time.</p>

<p>If you want to load a plugin in your own name space, use the '+' character before a package name like following:</p>

<pre><code>__PACKAGE__-&gt;load_plugins("+MyApp::Plugin::Foo"); # =&gt; loads MyApp::Plugin::Foo
</code></pre>
</li>
<li>
<p><code>MyApp-&gt;load_config()</code></p>

<p>You can get a configuration hashref from <code>config/$ENV{PLACK_ENV}.pl</code>. You can override this method for customizing configuration loading method.</p>
</li>
<li>
<p><code>MyApp-&gt;add_config()</code></p>

<p>DEPRECATED.</p>
</li>
<li>
<p><code>MyApp-&gt;debug_mode()</code></p>

<p><strong>((EXPERIMENTAL))</strong></p>

<p>This method returns a boolean value. It returns true when $ENV{AMON2_DEBUG} is true value, false otherwise.</p>

<p>You can override this method if you need.</p>
</li>
</ul><h1>
<a name="user-content-project-local-mode" class="anchor" href="#project-local-mode" aria-hidden="true"><span class="octicon octicon-link"></span></a>PROJECT LOCAL MODE</h1>

<p><strong>THIS MODE IS HIGHLY EXPERIMENTAL</strong></p>

<p>Normally, Amon2's context is stored in a global variable.</p>

<p>This module makes the context to project local.</p>

<p>It means, normally context class using Amon2 use <code>$Amon2::CONTEXT</code> in each project, but context class using <a href="#project-local-mode">"PROJECT LOCAL MODE"</a> use <code>$MyApp::CONTEXT</code>.</p>

<p><strong>It means you can't use code depend <code>&lt;Amon2-</code>context&gt;&gt; and <code>&lt;Amon2-</code>context&gt;&gt; under this mode.</strong>&gt;</p>

<h2>
<a name="user-content-notes-about-create_request" class="anchor" href="#notes-about-create_request" aria-hidden="true"><span class="octicon octicon-link"></span></a>NOTES ABOUT create_request</h2>

<p>Older <a href="https://metacpan.org/pod/Amon2::Web::Request">Amon2::Web::Request</a> has only 1 argument like following, it uses <code>Amon2-&gt;context</code> to get encoding:</p>

<pre><code>sub create_request {
    my ($class, $env) = @_;
    Amon2::Web::Request-&gt;new($env);
}
</code></pre>

<p>If you want to use <a href="#project-local-mode">"PROJECT LOCAL MODE"</a>, you need to pass class name of context class, as following:</p>

<pre><code>sub create_request {
    my ($class, $env) = @_;
    Amon2::Web::Request-&gt;new($env, $class);
}
</code></pre>

<h2>
<a name="user-content-how-do-i-enable-project-local-mode" class="anchor" href="#how-do-i-enable-project-local-mode" aria-hidden="true"><span class="octicon octicon-link"></span></a>HOW DO I ENABLE PROJECT LOCAL MODE?</h2>

<p><code>MyApp-</code>make_local_context() &gt; turns on the project local mode.</p>

<p>There is no way to revert it, thanks.</p>

<h2>
<a name="user-content-methods-1" class="anchor" href="#methods-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>METHODS</h2>

<p>This module inserts 3 methods to your context class.</p>

<ul class="task-list">
<li>
<p>MyApp-&gt;context()</p>

<p>Shorthand for $MyApp::CONTEXT</p>
</li>
<li>
<p>MyApp-&gt;set_context($context)</p>

<p>It's the same as:</p>

<pre><code>$MyApp::CONTEXT = $context
</code></pre>
</li>
<li>
<p>my $guard = MyApp-&gt;context_guard()</p>

<p>Create new context guard class.</p>

<p>It's the same as:</p>

<pre><code>Amon2::ContextGuard-&gt;new(shift, \$MyApp::CONTEXT);
</code></pre>
</li>
</ul><h1>
<a name="user-content-documents" class="anchor" href="#documents" aria-hidden="true"><span class="octicon octicon-link"></span></a>DOCUMENTS</h1>

<p>More complicated documents are available on <a href="http://amon.64p.org/">http://amon.64p.org/</a></p>

<h1>
<a name="user-content-supports" class="anchor" href="#supports" aria-hidden="true"><span class="octicon octicon-link"></span></a>SUPPORTS</h1>

<p>#amon at irc.perl.org is also available.</p>

<h1>
<a name="user-content-author" class="anchor" href="#author" aria-hidden="true"><span class="octicon octicon-link"></span></a>AUTHOR</h1>

<p>Tokuhiro Matsuno <a href="mailto:tokuhirom@gmail.com">tokuhirom@gmail.com</a></p>

<h1>
<a name="user-content-contributors" class="anchor" href="#contributors" aria-hidden="true"><span class="octicon octicon-link"></span></a>CONTRIBUTORS</h1>

<ul class="task-list">
<li>noblejasper</li>
<li>hiratara</li>
<li>s-aska</li>
<li>Kentaro Kuribayashi</li>
<li>Yuki Ibe</li>
<li>mattn</li>
<li>Masahiro Nagano</li>
<li>rightgo09</li>
<li>karupanerura</li>
<li>hatyuki</li>
<li>Keiji, Yoshimi</li>
<li>Nishibayashi Takuji</li>
<li>dragon3</li>
<li>Fuji, Goro</li>
<li>issm</li>
<li>hisaichi5518</li>
<li>Adrian</li>
<li>Fuji, Goro</li>
<li>ITO Nobuaki</li>
<li>Geraud CONTINSOUZAS</li>
<li>Syohei YOSHIDA</li>
<li>magnolia</li>
<li>Katsuhiro Konishi</li>
</ul><h1>
<a name="user-content-license" class="anchor" href="#license" aria-hidden="true"><span class="octicon octicon-link"></span></a>LICENSE</h1>

<p>This library is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p></article></div>
<div class="announce instapaper_body md" data-path="readme.md" id="readme"><article class="markdown-body entry-content" itemprop="mainContentOfPage"><h1>
<a name="user-content-flysystem-by-frankdejonge" class="anchor" href="#flysystem-by-frankdejonge" aria-hidden="true"><span class="octicon octicon-link"></span></a>Flysystem by <a href="http://twitter.com/frankdejonge">@frankdejonge</a>
</h1>

<p><a href="https://travis-ci.org/thephpleague/flysystem"><img src="https://camo.githubusercontent.com/686a6d56ba40aa8f481356132c54eca382ed2f97/68747470733a2f2f7472617669732d63692e6f72672f7468657068706c65616775652f666c7973797374656d2e706e67" alt="Build Status" data-canonical-src="https://travis-ci.org/thephpleague/flysystem.png" style="max-width:100%;"></a>
<a href="https://packagist.org/packages/league/flysystem"><img src="https://camo.githubusercontent.com/aff107732d60dcec03c7e57197ab6b4777ef5aee/68747470733a2f2f706f7365722e707567782e6f72672f6c65616775652f666c7973797374656d2f762f737461626c652e706e67" alt="Latest Stable Version" data-canonical-src="https://poser.pugx.org/league/flysystem/v/stable.png" style="max-width:100%;"></a>
<a href="https://packagist.org/packages/league/flysystem"><img src="https://camo.githubusercontent.com/bb9bdba0dbbeb1afdc8087eb1603acf82df7d368/68747470733a2f2f706f7365722e707567782e6f72672f6c65616775652f666c7973797374656d2f646f776e6c6f6164732e706e67" alt="Total Downloads" data-canonical-src="https://poser.pugx.org/league/flysystem/downloads.png" style="max-width:100%;"></a> <a href="https://packagist.org/packages/league/flysystem"><img src="https://camo.githubusercontent.com/e363ab717bf826aa8c43287f44acde6fb59cca57/68747470733a2f2f706f7365722e707567782e6f72672f6c65616775652f666c7973797374656d2f6c6963656e73652e706e67" alt="License" data-canonical-src="https://poser.pugx.org/league/flysystem/license.png" style="max-width:100%;"></a>
<a href="https://insight.sensiolabs.com/projects/9820f1af-2fd0-4ab6-b42a-03e0c821e0af"><img src="https://camo.githubusercontent.com/c452cf73ae9c0fcfb0a5e625f16f604d70aaa859/68747470733a2f2f696e73696768742e73656e73696f6c6162732e636f6d2f70726f6a656374732f39383230663161662d326664302d346162362d623432612d3033653063383231653061662f6d696e692e706e67" alt="SensioLabsInsight" data-canonical-src="https://insight.sensiolabs.com/projects/9820f1af-2fd0-4ab6-b42a-03e0c821e0af/mini.png" style="max-width:100%;"></a>
<a href="https://coveralls.io/r/thephpleague/flysystem"><img src="https://camo.githubusercontent.com/35c8b2b2e73c3ebc0bafff70a6b0388ec0c1e828/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f7468657068706c65616775652f666c7973797374656d2f62616467652e706e67" alt="Coverage Status" data-canonical-src="https://coveralls.io/repos/thephpleague/flysystem/badge.png" style="max-width:100%;"></a>
<a href="https://scrutinizer-ci.com/g/thephpleague/flysystem"><img src="https://camo.githubusercontent.com/2fef9af15231c334212946aa6d0dc1f5d10919bc/68747470733a2f2f7363727574696e697a65722d63692e636f6d2f672f7468657068706c65616775652f666c7973797374656d2f6261646765732f7175616c6974792d73636f72652e706e673f623d6d6173746572" alt="Code Quality" data-canonical-src="https://scrutinizer-ci.com/g/thephpleague/flysystem/badges/quality-score.png?b=master" style="max-width:100%;"></a></p>

<p>Flysystem is a filesystem abstraction which allows you to easily swap out a local filesystem for a remote one.</p>

<p><a href="https://packagist.org/packages/league/flysystem">Flysystem on Packagist</a></p>

<h1>
<a name="user-content-support-flysystem" class="anchor" href="#support-flysystem" aria-hidden="true"><span class="octicon octicon-link"></span></a>Support Flysystem</h1>

<p>Do you use Flysystem often? Supporting it through Gittip will help freeing up extra time for me to work on
bugs, new features and documentation.</p>

<p><a href="https://www.gittip.com/FrenkyNet/"><img src="https://camo.githubusercontent.com/e3199983eafb449b181d89db2b446026b1bf3d68/687474703a2f2f696d672e736869656c64732e696f2f6769747469702f4672656e6b794e65742e737667" alt="Support with Gittip" data-canonical-src="http://img.shields.io/gittip/FrenkyNet.svg" style="max-width:100%;"></a></p>

<h1>
<a name="user-content-goals" class="anchor" href="#goals" aria-hidden="true"><span class="octicon octicon-link"></span></a>Goals</h1>

<ul class="task-list">
<li>Have a generic API for handling common tasks across multiple file storage engines.</li>
<li>Have consistent output which you can rely on.</li>
<li>Integrate well with other packages/frameworks.</li>
<li>Be cacheable.</li>
<li>Emulate directories in systems that support none, like AwsS3.</li>
<li>Support third party plugins.</li>
<li>Make it easy to test your filesystem interactions.</li>
<li>Support streams for big file handling</li>
</ul><h1>
<a name="user-content-installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h1>

<p>Through Composer, obviously:</p>

<div class="highlight highlight-json"><pre><span class="p">{</span>
    <span class="nt">"require"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"league/flysystem"</span><span class="p">:</span> <span class="s2">"0.5.*"</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>You can also use Flysystem without using Composer by registering an autoloader function:</p>

<div class="highlight highlight-php"><pre><span class="nb">spl_autoload_register</span><span class="p">(</span><span class="k">function</span><span class="p">(</span><span class="nv">$class</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$prefix</span> <span class="o">=</span> <span class="s1">'League\\Flysystem\\'</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$class</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span> <span class="o">===</span> <span class="nv">$prefix</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nv">$class</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$class</span><span class="p">,</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$prefix</span><span class="p">));</span>
    <span class="nv">$location</span> <span class="o">=</span> <span class="nx">__DIR__</span> <span class="o">.</span> <span class="s1">'path/to/flysystem/src/'</span> <span class="o">.</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s1">'\\'</span><span class="p">,</span> <span class="s1">'/'</span><span class="p">,</span> <span class="nv">$class</span><span class="p">)</span> <span class="o">.</span> <span class="s1">'.php'</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$location</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">require_once</span><span class="p">(</span><span class="nv">$location</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>

<h2>
<a name="user-content-integrations" class="anchor" href="#integrations" aria-hidden="true"><span class="octicon octicon-link"></span></a>Integrations</h2>

<p>Want to get started quickly? Check out some of these integrations:</p>

<ul class="task-list">
<li>Laravel integration: <a href="https://github.com/GrahamCampbell/Laravel-Flysystem">https://github.com/GrahamCampbell/Laravel-Flysystem</a>
</li>
<li>Symfony integration: <a href="https://github.com/1up-lab/OneupFlysystemBundle">https://github.com/1up-lab/OneupFlysystemBundle</a>
</li>
<li>Backup manager: <a href="https://github.com/heybigname/backup-manager">https://github.com/heybigname/backup-manager</a>
</li>
</ul><h2>
<a name="user-content-adapters" class="anchor" href="#adapters" aria-hidden="true"><span class="octicon octicon-link"></span></a>Adapters</h2>

<ul class="task-list">
<li>Local</li>
<li>Amazon Web Services - S3</li>
<li>Rackspace Cloud Files</li>
<li>Dropbox</li>
<li>Ftp</li>
<li>Sftp (through phpseclib)</li>
<li>Zip (through ZipArchive)</li>
<li>WebDAV (through SabreDAV)</li>
<li>NullAdapter</li>
</ul><h3>
<a name="user-content-planned-adapters" class="anchor" href="#planned-adapters" aria-hidden="true"><span class="octicon octicon-link"></span></a>Planned Adapters</h3>

<ul class="task-list">
<li>Azure (PR welcome)</li>
<li>PR's welcome?</li>
</ul><h2>
<a name="user-content-caching" class="anchor" href="#caching" aria-hidden="true"><span class="octicon octicon-link"></span></a>Caching</h2>

<ul class="task-list">
<li>Memory (array caching)</li>
<li>Redis (through Predis)</li>
<li>Memcached</li>
<li>Adapter</li>
</ul><h2>
<a name="user-content-local-setup" class="anchor" href="#local-setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Local Setup</h2>

<div class="highlight highlight-php"><pre><span class="k">use</span> <span class="nx">League\Flysystem\Filesystem</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Adapter\Local</span> <span class="k">as</span> <span class="nx">Adapter</span><span class="p">;</span>

<span class="nv">$filesystem</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Filesystem</span><span class="p">(</span><span class="k">new</span> <span class="nx">Adapter</span><span class="p">(</span><span class="nx">__DIR__</span><span class="o">.</span><span class="s1">'/path/to/root'</span><span class="p">));</span>
</pre></div>

<h2>
<a name="user-content-zip-archive-setup" class="anchor" href="#zip-archive-setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Zip Archive Setup</h2>

<div class="highlight highlight-php"><pre><span class="k">use</span> <span class="nx">League\Flysystem\Filesystem</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Adapter\Zip</span> <span class="k">as</span> <span class="nx">Adapter</span><span class="p">;</span>

<span class="nv">$filesystem</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Filesystem</span><span class="p">(</span><span class="k">new</span> <span class="nx">Adapter</span><span class="p">(</span><span class="nx">__DIR__</span><span class="o">.</span><span class="s1">'/path/to/archive.zip'</span><span class="p">));</span>
</pre></div>

<h2>
<a name="user-content-aws-s3-setup" class="anchor" href="#aws-s3-setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>AWS S3 Setup</h2>

<div class="highlight highlight-php"><pre><span class="k">use</span> <span class="nx">Aws\S3\S3Client</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Filesystem</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Adapter\AwsS3</span> <span class="k">as</span> <span class="nx">Adapter</span><span class="p">;</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="nx">S3Client</span><span class="o">::</span><span class="na">factory</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'key'</span>    <span class="o">=&gt;</span> <span class="s1">'[your key]'</span><span class="p">,</span>
    <span class="s1">'secret'</span> <span class="o">=&gt;</span> <span class="s1">'[your secret]'</span><span class="p">,</span>
<span class="p">));</span>

<span class="nv">$filesystem</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Filesystem</span><span class="p">(</span><span class="k">new</span> <span class="nx">Adapter</span><span class="p">(</span><span class="nv">$client</span><span class="p">,</span> <span class="s1">'bucket-name'</span><span class="p">,</span> <span class="s1">'optional-prefix'</span><span class="p">));</span>
</pre></div>

<h2>
<a name="user-content-rackspace-setup" class="anchor" href="#rackspace-setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Rackspace Setup</h2>

<div class="highlight highlight-php"><pre><span class="k">use</span> <span class="nx">OpenCloud\OpenStack</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">OpenCloud\Rackspace</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Filesystem</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Adapter\Rackspace</span> <span class="k">as</span> <span class="nx">Adapter</span><span class="p">;</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenStack</span><span class="p">(</span><span class="nx">Rackspace</span><span class="o">::</span><span class="na">UK_IDENTITY_ENDPOINT</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="s1">':username'</span><span class="p">,</span>
    <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="s1">':password'</span><span class="p">,</span>
<span class="p">));</span>

<span class="nv">$store</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">objectStoreService</span><span class="p">(</span><span class="s1">'cloudFiles'</span><span class="p">,</span> <span class="s1">'LON'</span><span class="p">);</span>
<span class="nv">$container</span> <span class="o">=</span> <span class="nv">$store</span><span class="o">-&gt;</span><span class="na">getContainer</span><span class="p">(</span><span class="s1">'flysystem'</span><span class="p">);</span>

<span class="nv">$filesystem</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Filesystem</span><span class="p">(</span><span class="k">new</span> <span class="nx">Adapter</span><span class="p">(</span><span class="nv">$container</span><span class="p">));</span>
</pre></div>

<p>You can also use a prefix to "namespace" your filesystem.</p>

<div class="highlight highlight-php"><pre><span class="nv">$filesystem</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Filesystem</span><span class="p">(</span><span class="k">new</span> <span class="nx">Adapter\Rackspace</span><span class="p">(</span><span class="nv">$container</span><span class="p">,</span> <span class="s1">'prefix'</span><span class="p">));</span>
</pre></div>

<h2>
<a name="user-content-dropbox-setup" class="anchor" href="#dropbox-setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dropbox Setup</h2>

<div class="highlight highlight-php"><pre><span class="k">use</span> <span class="nx">Dropbox\Client</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Filesystem</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Adapter\Dropbox</span> <span class="k">as</span> <span class="nx">Adapter</span><span class="p">;</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">(</span><span class="nv">$token</span><span class="p">,</span> <span class="nv">$appName</span><span class="p">);</span>
<span class="nv">$filesystem</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Filesystem</span><span class="p">(</span><span class="k">new</span> <span class="nx">Adapter</span><span class="p">(</span><span class="nv">$client</span><span class="p">,</span> <span class="s1">'optional/path/prefix'</span><span class="p">));</span>
</pre></div>

<h2>
<a name="user-content-ftp-setup" class="anchor" href="#ftp-setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>FTP Setup</h2>

<div class="highlight highlight-php"><pre><span class="k">use</span> <span class="nx">League\Flysystem\Filesystem</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Adapter\Ftp</span> <span class="k">as</span> <span class="nx">Adapter</span><span class="p">;</span>

<span class="nv">$filesystem</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Filesystem</span><span class="p">(</span><span class="k">new</span> <span class="nx">Adapter</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'host'</span> <span class="o">=&gt;</span> <span class="s1">'ftp.example.com'</span><span class="p">,</span>
    <span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="s1">'username'</span><span class="p">,</span>
    <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="s1">'password'</span><span class="p">,</span>

    <span class="sd">/** optional config settings */</span>
    <span class="s1">'port'</span> <span class="o">=&gt;</span> <span class="mi">21</span><span class="p">,</span>
    <span class="s1">'root'</span> <span class="o">=&gt;</span> <span class="s1">'/path/to/root'</span><span class="p">,</span>
    <span class="s1">'passive'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">'ssl'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">'timeout'</span> <span class="o">=&gt;</span> <span class="mi">30</span><span class="p">,</span>
<span class="p">)));</span>
</pre></div>

<h2>
<a name="user-content-sftp-setup" class="anchor" href="#sftp-setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>SFTP Setup</h2>

<div class="highlight highlight-php"><pre><span class="k">use</span> <span class="nx">League\Flysystem\Filesystem</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Adapter\Sftp</span> <span class="k">as</span> <span class="nx">Adapter</span><span class="p">;</span>

<span class="nv">$filesystem</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Filesystem</span><span class="p">(</span><span class="k">new</span> <span class="nx">Adapter</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'host'</span> <span class="o">=&gt;</span> <span class="s1">'example.com'</span><span class="p">,</span>
    <span class="s1">'port'</span> <span class="o">=&gt;</span> <span class="mi">21</span><span class="p">,</span>
    <span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="s1">'username'</span><span class="p">,</span>
    <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="s1">'password'</span><span class="p">,</span>
    <span class="s1">'privateKey'</span> <span class="o">=&gt;</span> <span class="s1">'path/to/or/contents/of/privatekey'</span><span class="p">,</span>
    <span class="s1">'root'</span> <span class="o">=&gt;</span> <span class="s1">'/path/to/root'</span><span class="p">,</span>
    <span class="s1">'timeout'</span> <span class="o">=&gt;</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">)));</span>
</pre></div>

<h2>
<a name="user-content-webdav-setup" class="anchor" href="#webdav-setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>WebDAV Setup</h2>

<div class="highlight highlight-php"><pre><span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sabre\DAV\Client</span><span class="p">(</span><span class="nv">$settings</span><span class="p">);</span>
<span class="nv">$adapter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">League\Flysystem\Adapter\WebDav</span><span class="p">(</span><span class="nv">$client</span><span class="p">);</span>
<span class="nv">$flysystem</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">League\Flysystem\Filesystem</span><span class="p">(</span><span class="nv">$adapter</span><span class="p">);</span>
</pre></div>

<h2>
<a name="user-content-nulladapter-setup" class="anchor" href="#nulladapter-setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>NullAdapter Setup</h2>

<p>This adapter acts like /dev/null, you can only write to it. Reading from it is never possible.</p>

<div class="highlight highlight-php"><pre><span class="nv">$adapter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">League\Flysystem\Adapter\NullAdapter</span><span class="p">;</span>
<span class="nv">$flysystem</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">League\Flysystem\Filesystem</span><span class="p">(</span><span class="nv">$adapter</span><span class="p">);</span>
</pre></div>

<h2>
<a name="user-content-predis-caching-setup" class="anchor" href="#predis-caching-setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Predis Caching Setup</h2>

<div class="highlight highlight-php"><pre><span class="k">use</span> <span class="nx">League\Flysystem\Filesystem</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Adapter\Local</span> <span class="k">as</span> <span class="nx">Adapter</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Cache\Predis</span> <span class="k">as</span> <span class="nx">Cache</span><span class="p">;</span>

<span class="nv">$filesystem</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Filesystem</span><span class="p">(</span><span class="k">new</span> <span class="nx">Adapter</span><span class="p">(</span><span class="nx">__DIR__</span><span class="o">.</span><span class="s1">'/path/to/root'</span><span class="p">),</span> <span class="k">new</span> <span class="nx">Cache</span><span class="p">);</span>

<span class="c1">// Or supply a client</span>
<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Predis\Client</span><span class="p">;</span>
<span class="nv">$filesystem</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Filesystem</span><span class="p">(</span><span class="k">new</span> <span class="nx">Adapter</span><span class="p">(</span><span class="nx">__DIR__</span><span class="o">.</span><span class="s1">'/path/to/root'</span><span class="p">),</span> <span class="k">new</span> <span class="nx">Cache</span><span class="p">(</span><span class="nv">$client</span><span class="p">));</span>
</pre></div>

<h2>
<a name="user-content-memcached-caching-setup" class="anchor" href="#memcached-caching-setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Memcached Caching Setup</h2>

<div class="highlight highlight-php"><pre><span class="k">use</span> <span class="nx">League\Flysystem\Filesystem</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Adapter\Local</span> <span class="k">as</span> <span class="nx">Adapter</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Cache\Memcached</span> <span class="k">as</span> <span class="nx">Cache</span><span class="p">;</span>

<span class="nv">$memcached</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Memcached</span><span class="p">;</span>
<span class="nv">$memcached</span><span class="o">-&gt;</span><span class="na">addServer</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="mi">11211</span><span class="p">);</span>

<span class="nv">$filesystem</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Filesystem</span><span class="p">(</span><span class="k">new</span> <span class="nx">Adapter</span><span class="p">(</span><span class="nx">__DIR__</span><span class="o">.</span><span class="s1">'/path/to/root'</span><span class="p">),</span> <span class="k">new</span> <span class="nx">Cache</span><span class="p">(</span><span class="nv">$memcached</span><span class="p">,</span> <span class="s1">'storageKey'</span><span class="p">,</span> <span class="mi">300</span><span class="p">));</span>
<span class="c1">// Storage Key and expire time are optional</span>
</pre></div>

<h2>
<a name="user-content-adapter-caching-setup" class="anchor" href="#adapter-caching-setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Adapter Caching Setup</h2>

<div class="highlight highlight-php"><pre><span class="k">use</span> <span class="nx">Dropbox\Client</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Filesystem</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Adapter\Dropbox</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Adapter\Local</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Cache\Adapter</span><span class="p">;</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">(</span><span class="s1">'token'</span><span class="p">,</span> <span class="s1">'app'</span><span class="p">);</span>
<span class="nv">$dropbox</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dropbox</span><span class="p">(</span><span class="nv">$client</span><span class="p">,</span> <span class="s1">'prefix'</span><span class="p">);</span>

<span class="nv">$local</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Local</span><span class="p">(</span><span class="s1">'path'</span><span class="p">);</span>
<span class="nv">$cache</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Adapter</span><span class="p">(</span><span class="nv">$local</span><span class="p">,</span> <span class="s1">'file'</span><span class="p">,</span> <span class="mi">300</span><span class="p">);</span>
<span class="c1">// Expire time is optional</span>

<span class="nv">$filesystem</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Filesystem</span><span class="p">(</span><span class="nv">$dropbox</span><span class="p">,</span> <span class="nv">$cache</span><span class="p">);</span>
</pre></div>

<h2>
<a name="user-content-general-usage" class="anchor" href="#general-usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>General Usage</h2>

<p><strong>Write Files</strong></p>

<div class="highlight highlight-php"><pre><span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">'filename.txt'</span><span class="p">,</span> <span class="s1">'contents'</span><span class="p">);</span>
</pre></div>

<p><strong>Update Files</strong></p>

<div class="highlight highlight-php"><pre><span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">update</span><span class="p">(</span><span class="s1">'filename.txt'</span><span class="p">,</span> <span class="s1">'new contents'</span><span class="p">);</span>
</pre></div>

<p><strong>Write or Update Files</strong></p>

<div class="highlight highlight-php"><pre><span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">put</span><span class="p">(</span><span class="s1">'filename.txt'</span><span class="p">,</span> <span class="s1">'contents'</span><span class="p">);</span>
</pre></div>

<p><strong>Read Files</strong></p>

<div class="highlight highlight-php"><pre><span class="nv">$contents</span> <span class="o">=</span> <span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">read</span><span class="p">(</span><span class="s1">'filename.txt'</span><span class="p">);</span>
</pre></div>

<p><strong>Check if a file exists</strong></p>

<div class="highlight highlight-php"><pre><span class="nv">$exists</span> <span class="o">=</span> <span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">has</span><span class="p">(</span><span class="s1">'filename.txt'</span><span class="p">);</span>
</pre></div>

<p><strong>Delete Files</strong></p>

<div class="highlight highlight-php"><pre><span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">(</span><span class="s1">'filename.txt'</span><span class="p">);</span>
</pre></div>

<p><strong>Read and Delete</strong></p>

<div class="highlight highlight-php"><pre><span class="nv">$contents</span> <span class="o">=</span> <span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">readAndDelete</span><span class="p">(</span><span class="s1">'filename.txt'</span><span class="p">);</span>
</pre></div>

<p><strong>Rename Files</strong></p>

<div class="highlight highlight-php"><pre><span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">rename</span><span class="p">(</span><span class="s1">'filename.txt'</span><span class="p">,</span> <span class="s1">'newname.txt'</span><span class="p">);</span>
</pre></div>

<p><strong>Get Mimetypes</strong></p>

<div class="highlight highlight-php"><pre><span class="nv">$mimetype</span> <span class="o">=</span> <span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">getMimetype</span><span class="p">(</span><span class="s1">'filename.txt'</span><span class="p">);</span>
</pre></div>

<p><strong>Get Timestamps</strong></p>

<div class="highlight highlight-php"><pre><span class="nv">$timestamp</span> <span class="o">=</span> <span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">getTimestamp</span><span class="p">(</span><span class="s1">'filename.txt'</span><span class="p">);</span>
</pre></div>

<p><strong>Get File Sizes</strong></p>

<div class="highlight highlight-php"><pre><span class="nv">$size</span> <span class="o">=</span> <span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">getSize</span><span class="p">(</span><span class="s1">'filename.txt'</span><span class="p">);</span>
</pre></div>

<p><strong>Create Directories</strong></p>

<div class="highlight highlight-php"><pre><span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">createDir</span><span class="p">(</span><span class="s1">'nested/directory'</span><span class="p">);</span>
</pre></div>

<p>Directories are also made implicitly when writing to a deeper path</p>

<div class="highlight highlight-php"><pre><span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">'path/to/filename.txt'</span><span class="p">,</span> <span class="s1">'contents'</span><span class="p">);</span>
</pre></div>

<p><strong>Delete Directories</strong></p>

<div class="highlight highlight-php"><pre><span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">deleteDir</span><span class="p">(</span><span class="s1">'path/to/directory'</span><span class="p">);</span>
</pre></div>

<p><strong>Manage Visibility</strong></p>

<p>Visibility is the abstraction of file permissions across multiple platforms. Visibility can be either public or private.</p>

<div class="highlight highlight-php"><pre><span class="k">use</span> <span class="nx">League\Flysystem\AdapterInterface</span><span class="p">;</span>
<span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">'db.backup'</span><span class="p">,</span> <span class="nv">$backup</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">'visibility'</span> <span class="o">=&gt;</span> <span class="nx">AdapterInterface</span><span class="o">::</span><span class="na">VISIBILITY_PRIVATE</span><span class="p">),</span>
<span class="p">]);</span>
<span class="c1">// or simply</span>
<span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">'db.backup'</span><span class="p">,</span> <span class="nv">$backup</span><span class="p">,</span> <span class="p">[</span><span class="s1">'visibility'</span> <span class="o">=&gt;</span> <span class="s1">'private'</span><span class="p">]);</span>
</pre></div>

<p>You can also change and check visibility of existing files</p>

<div class="highlight highlight-php"><pre><span class="k">if</span> <span class="p">(</span><span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">getVisibility</span><span class="p">(</span><span class="s1">'secret.txt'</span><span class="p">)</span> <span class="o">===</span> <span class="s1">'private'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">setVisibility</span><span class="p">(</span><span class="s1">'secret.txt'</span><span class="p">,</span> <span class="s1">'public'</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<h2>
<a name="user-content-global-visibility-setting" class="anchor" href="#global-visibility-setting" aria-hidden="true"><span class="octicon octicon-link"></span></a>Global visibility setting</h2>

<p>You can set the visibility as a default, which prevents you from setting it all over the place.</p>

<div class="highlight highlight-php"><pre><span class="nv">$filesystem</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">League\Flysystem\Filesystem</span><span class="p">(</span><span class="nv">$adapter</span><span class="p">,</span> <span class="nv">$cache</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">'visibility'</span> <span class="o">=&gt;</span> <span class="nx">AdapterInterface</span><span class="o">::</span><span class="na">VISIBILITY_PRIVATE</span>
<span class="p">]);</span>
</pre></div>

<p><strong><em>List Contents</em></strong></p>

<div class="highlight highlight-php"><pre><span class="nv">$contents</span> <span class="o">=</span> <span class="nv">$filemanager</span><span class="o">-&gt;</span><span class="na">listContents</span><span class="p">();</span>
</pre></div>

<p>The result of a contents listing is a collection of arrays containing all the metadata the file manager knows at that time. By default a you'll receive path info and file type. Additional info could be supplied by default depending on the adapter used.</p>

<p>Example:</p>

<div class="highlight highlight-php"><pre><span class="k">foreach</span> <span class="p">(</span><span class="nv">$contents</span> <span class="k">as</span> <span class="nv">$object</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$object</span><span class="p">[</span><span class="s1">'basename'</span><span class="p">]</span><span class="o">.</span><span class="s1">' is located at'</span><span class="o">.</span><span class="nv">$object</span><span class="p">[</span><span class="s1">'path'</span><span class="p">]</span><span class="o">.</span><span class="s1">' and is a '</span><span class="o">.</span><span class="nv">$object</span><span class="p">[</span><span class="s1">'type'</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>

<p>By default Flysystem lists the top directory non-recursively. You can supply a directory name and recursive boolean to get more precise results</p>

<div class="highlight highlight-php"><pre><span class="nv">$contents</span> <span class="o">=</span> <span class="nv">$flysystem</span><span class="o">-&gt;</span><span class="na">listContents</span><span class="p">(</span><span class="s1">'some/dir'</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</pre></div>

<p><strong><em>List paths</em></strong></p>

<div class="highlight highlight-php"><pre><span class="nv">$paths</span> <span class="o">=</span> <span class="nv">$filemanager</span><span class="o">-&gt;</span><span class="na">listPaths</span><span class="p">();</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$paths</span> <span class="k">as</span> <span class="nv">$path</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$path</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p><strong><em>List with ensured presence of specific metadata</em></strong></p>

<div class="highlight highlight-php"><pre><span class="nv">$listing</span> <span class="o">=</span> <span class="nv">$flysystem</span><span class="o">-&gt;</span><span class="na">listWith</span><span class="p">([</span><span class="s1">'mimetype'</span><span class="p">,</span> <span class="s1">'size'</span><span class="p">,</span> <span class="s1">'timestamp'</span><span class="p">],</span> <span class="s1">'optional/path/to/dir'</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$listing</span> <span class="k">as</span> <span class="nv">$object</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$object</span><span class="p">[</span><span class="s1">'path'</span><span class="p">]</span><span class="o">.</span><span class="s1">' has mimetype: '</span><span class="o">.</span><span class="nv">$object</span><span class="p">[</span><span class="s1">'mimetype'</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>

<p><strong><em>Get file into with explicit metadata</em></strong></p>

<div class="highlight highlight-php"><pre><span class="nv">$info</span> <span class="o">=</span> <span class="nv">$flysystem</span><span class="o">-&gt;</span><span class="na">getWithMetadata</span><span class="p">(</span><span class="s1">'path/to/file.txt'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'timestamp'</span><span class="p">,</span> <span class="s1">'mimetype'</span><span class="p">]);</span>
<span class="k">echo</span> <span class="nv">$info</span><span class="p">[</span><span class="s1">'mimetype'</span><span class="p">];</span>
<span class="k">echo</span> <span class="nv">$info</span><span class="p">[</span><span class="s1">'timestamp'</span><span class="p">];</span>
</pre></div>

<h2>
<a name="user-content-using-streams-for-reads-and-writes" class="anchor" href="#using-streams-for-reads-and-writes" aria-hidden="true"><span class="octicon octicon-link"></span></a>Using streams for reads and writes</h2>

<div class="highlight highlight-php"><pre><span class="nv">$stream</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="s1">'/path/to/database.backup'</span><span class="p">,</span> <span class="s1">'r+'</span><span class="p">);</span>
<span class="nv">$flysystem</span><span class="o">-&gt;</span><span class="na">writeStream</span><span class="p">(</span><span class="s1">'backups/'</span> <span class="o">.</span> <span class="nb">strftime</span><span class="p">(</span><span class="s1">'%G-%m-%d'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">'.backup'</span><span class="p">,</span> <span class="nv">$stream</span><span class="p">);</span>

<span class="c1">// Using write you can also directly set the visibility</span>
<span class="nv">$flysystem</span><span class="o">-&gt;</span><span class="na">writeStream</span><span class="p">(</span><span class="s1">'backups/'</span> <span class="o">.</span> <span class="nb">strftime</span><span class="p">(</span><span class="s1">'%G-%m-%d'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">'.backup'</span><span class="p">,</span> <span class="nv">$stream</span><span class="p">,</span> <span class="s1">'private'</span><span class="p">);</span>

<span class="c1">// Or update a file with stream contents</span>
<span class="nv">$flysystem</span><span class="o">-&gt;</span><span class="na">updateStream</span><span class="p">(</span><span class="s1">'backups/'</span> <span class="o">.</span> <span class="nb">strftime</span><span class="p">(</span><span class="s1">'%G-%m-%d'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">'.backup'</span><span class="p">,</span> <span class="nv">$stream</span><span class="p">);</span>

<span class="c1">// Retrieve a read-stream</span>
<span class="nv">$stream</span> <span class="o">=</span> <span class="nv">$flysystem</span><span class="o">-&gt;</span><span class="na">readStream</span><span class="p">(</span><span class="s1">'something/is/here.ext'</span><span class="p">);</span>
<span class="nv">$contents</span> <span class="o">=</span> <span class="nb">stream_get_contents</span><span class="p">(</span><span class="nv">$stream</span><span class="p">);</span>
<span class="nb">fclose</span><span class="p">(</span><span class="nv">$stream</span><span class="p">);</span>

<span class="c1">// Create or overwrite using a stream.</span>
<span class="nv">$putStream</span> <span class="o">=</span> <span class="nb">tmpfile</span><span class="p">();</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nv">$putStream</span><span class="p">,</span> <span class="nv">$contents</span><span class="p">);</span>
<span class="nb">rewind</span><span class="p">(</span><span class="nv">$putStream</span><span class="p">);</span>
<span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">putStream</span><span class="p">(</span><span class="s1">'somewhere/here.txt'</span><span class="p">,</span> <span class="nv">$putStream</span><span class="p">);</span>
<span class="nb">fclose</span><span class="p">(</span><span class="nv">$putStream</span><span class="p">);</span>
</pre></div>

<h2>
<a name="user-content-s3-and-writestream" class="anchor" href="#s3-and-writestream" aria-hidden="true"><span class="octicon octicon-link"></span></a>S3 and writeStream</h2>

<p>In order to get the correct mime type for the object, supply it like so:</p>

<div class="highlight highlight-php"><pre><span class="nv">$s3</span><span class="o">-&gt;</span><span class="na">writeStream</span><span class="p">(</span><span class="s1">'path/to/object.png'</span><span class="p">,</span> <span class="nv">$stream</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">'visibility'</span> <span class="o">=&gt;</span> <span class="s1">'public'</span><span class="p">,</span>
    <span class="s1">'mimetype'</span> <span class="o">=&gt;</span> <span class="s1">'image/png'</span><span class="p">,</span>
<span class="p">]);</span>
</pre></div>

<h2>
<a name="user-content-events" class="anchor" href="#events" aria-hidden="true"><span class="octicon octicon-link"></span></a>Events</h2>

<p>Flysystem comes with an integration of the Event package (also provided by the PHP League).
In this case you can use the <code>League\Flysystem\EventableFilesystem</code>. This will expose the same API
as the <code>League\Flysystem\Filesystem</code> class but exposes events for every method call. Events allow
you to hook into Flysystem by exposing a before and after event for every method.</p>

<div class="highlight highlight-php"><pre><span class="k">use</span> <span class="nx">League\Flysystem\EventableFilesystem</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Event\Before</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Event\After</span><span class="p">;</span>

<span class="nv">$filesystem</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">League\Flysystem\EventableFilesystem</span><span class="p">(</span><span class="nv">$adapter</span><span class="p">,</span> <span class="nv">$cache</span><span class="p">,</span> <span class="nv">$options</span><span class="p">);</span>
<span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">addListener</span><span class="p">(</span><span class="s1">'before.read'</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nx">Before</span> <span class="nv">$event</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Get a parameter</span>
    <span class="nv">$path</span> <span class="o">=</span> <span class="nv">$event</span><span class="o">-&gt;</span><span class="na">getArgument</span><span class="p">(</span><span class="s1">'path'</span><span class="p">);</span>

    <span class="c1">// Overwrite a parameter</span>
    <span class="nv">$event</span><span class="o">-&gt;</span><span class="na">setArgument</span><span class="p">(</span><span class="s1">'path'</span><span class="p">,</span> <span class="s1">'/another/path.ext'</span><span class="p">);</span>

    <span class="c1">// Cancel the operation</span>
    <span class="nv">$event</span><span class="o">-&gt;</span><span class="na">cancelOperation</span><span class="p">(</span><span class="s1">'optional alternative return value'</span><span class="p">);</span>
<span class="p">});</span>

<span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">addListener</span><span class="p">(</span><span class="s1">'after.read'</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nx">After</span> <span class="nv">$event</span><span class="p">))</span> <span class="p">{</span>
    <span class="c1">// Get the response</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="nv">$event</span><span class="o">-&gt;</span><span class="na">getResponse</span><span class="p">();</span>

    <span class="c1">// Overwrite the response</span>
    <span class="nv">$event</span><span class="o">-&gt;</span><span class="na">setResponse</span><span class="p">(</span><span class="s1">'altered response'</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

<h2>
<a name="user-content-plugins" class="anchor" href="#plugins" aria-hidden="true"><span class="octicon octicon-link"></span></a>Plugins</h2>

<p>Need a feature which is not included in Flysystem's bag of tricks? Write a plugin!</p>

<div class="highlight highlight-php"><pre><span class="k">use</span> <span class="nx">League\Flysystem\FilesystemInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\PluginInterface</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MaximusAwesomeness</span> <span class="k">implements</span> <span class="nx">PluginInterface</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="nv">$filesystem</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">setFilesystem</span><span class="p">(</span><span class="nx">FilesystemInterface</span> <span class="nv">$filesystem</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filesystem</span> <span class="o">=</span> <span class="nv">$filesystem</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">getMethod</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="s1">'getDown'</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">handle</span><span class="p">(</span><span class="nv">$path</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$contents</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filesystem</span><span class="o">-&gt;</span><span class="na">read</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>

        <span class="k">return</span> <span class="nb">sha1</span><span class="p">(</span><span class="nv">$contents</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>Now we're ready to use the plugin</p>

<div class="highlight highlight-php"><pre><span class="k">use</span> <span class="nx">League\Flysystem\Filesystem</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">League\Flysystem\Adapter</span><span class="p">;</span>

<span class="nv">$filesystem</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Filesystem</span><span class="p">(</span><span class="k">new</span> <span class="nx">Adapter\Local</span><span class="p">(</span><span class="nx">__DIR__</span><span class="o">.</span><span class="s1">'/path/to/files/'</span><span class="p">));</span>
<span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">addPlugin</span><span class="p">(</span><span class="k">new</span> <span class="nx">MaximusAwesomeness</span><span class="p">);</span>
<span class="nv">$sha1</span> <span class="o">=</span> <span class="nv">$filesystem</span><span class="o">-&gt;</span><span class="na">getDown</span><span class="p">(</span><span class="s1">'path/to/file'</span><span class="p">);</span>
</pre></div>

<h1>
<a name="user-content-mount-manager" class="anchor" href="#mount-manager" aria-hidden="true"><span class="octicon octicon-link"></span></a>Mount Manager</h1>

<p>Flysystem comes with an wrapper class to easily work with multiple filesystem instances
from a single object. The <code>Flysystem\MountManager</code> is an easy to use container allowing
you do simplify complex cross-filesystem interactions.</p>

<p>Setting up a Mount Manager is easy:</p>

<div class="highlight highlight-php"><pre><span class="nv">$ftp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">League\Flysystem\Filesystem</span><span class="p">(</span><span class="nv">$ftpAdapter</span><span class="p">);</span>
<span class="nv">$s3</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">League\Flysystem\Filesystem</span><span class="p">(</span><span class="nv">$s3Adapter</span><span class="p">);</span>
<span class="nv">$local</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">League\Flysystem\Filesystem</span><span class="p">(</span><span class="nv">$localAdapter</span><span class="p">);</span>

<span class="c1">// Add them in the constructor</span>
<span class="nv">$manager</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">League\Flysystem\MountManager</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'ftp'</span> <span class="o">=&gt;</span> <span class="nv">$ftp</span><span class="p">,</span>
    <span class="s1">'s3'</span> <span class="o">=&gt;</span> <span class="nv">$s3</span><span class="p">,</span>
<span class="p">));</span>

<span class="c1">// Or mount them later</span>
<span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">mountFilesystem</span><span class="p">(</span><span class="s1">'local'</span><span class="p">,</span> <span class="nv">$local</span><span class="p">);</span>
</pre></div>

<p>Now we do all the file operations we'd normally do on a <code>Flysystem\Filesystem</code> instance.</p>

<div class="highlight highlight-php"><pre><span class="c1">// Read from FTP</span>
<span class="nv">$contents</span> <span class="o">=</span> <span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">read</span><span class="p">(</span><span class="s1">'ftp://some/file.txt'</span><span class="p">);</span>

<span class="c1">// And write to local</span>
<span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">'local://put/it/here.txt'</span><span class="p">,</span> <span class="nv">$contents</span><span class="p">);</span>
</pre></div>

<p>This makes it easy to code up simple sync strategies.</p>

<div class="highlight highlight-php"><pre><span class="nv">$contents</span> <span class="o">=</span> <span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">listContents</span><span class="p">(</span><span class="s1">'local://uploads'</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$contents</span> <span class="k">as</span> <span class="nv">$entry</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$update</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">has</span><span class="p">(</span><span class="s1">'storage://'</span><span class="o">.</span><span class="nv">$entry</span><span class="p">[</span><span class="s1">'path'</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$update</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">elseif</span> <span class="p">(</span><span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">getTimestamp</span><span class="p">(</span><span class="s1">'local://'</span><span class="o">.</span><span class="nv">$entry</span><span class="p">[</span><span class="s1">'path'</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">getTimestamp</span><span class="p">(</span><span class="s1">'storage://'</span><span class="o">.</span><span class="nv">$entry</span><span class="p">[</span><span class="s1">'path'</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$update</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$update</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">put</span><span class="p">(</span><span class="s1">'storage://'</span><span class="o">.</span><span class="nv">$entry</span><span class="p">[</span><span class="s1">'path'</span><span class="p">],</span> <span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">read</span><span class="p">(</span><span class="s1">'local://'</span><span class="o">.</span><span class="nv">$entry</span><span class="p">[</span><span class="s1">'path'</span><span class="p">]));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h1>
<a name="user-content-enjoy" class="anchor" href="#enjoy" aria-hidden="true"><span class="octicon octicon-link"></span></a>Enjoy.</h1>

<p>Oh and if you've come down this far, you might as well follow me on <a href="http://twitter.com/frankdejonge">twitter</a>.</p></article></div>